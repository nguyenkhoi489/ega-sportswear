{"version":3,"file":"yith-wcan-shortcodes.js","mappings":"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","sources":["webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/globals.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-filter.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-filter-labels.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-reset-button.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-modal-opener.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-dropdown.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-preset.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-dropdown-premium.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-preset-premium.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/index.js"],"sourcesContent":["'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nconst $ = jQuery, // we can do this as WebPack will compact all together inside a closure.\n\t$body = $( 'body' ),\n\tblock = ( $el ) => {\n\t\tif ( typeof $.fn.block === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet background = '#fff center center no-repeat';\n\n\t\tif (\n\t\t\t'undefined' !== typeof yith_wcan_shortcodes &&\n\t\t\tyith_wcan_shortcodes?.loader\n\t\t) {\n\t\t\tbackground = `url('${ yith_wcan_shortcodes.loader }') ${ background }`;\n\t\t}\n\n\t\t$el.block( {\n\t\t\tmessage: null,\n\t\t\toverlayCSS: {\n\t\t\t\tbackground,\n\t\t\t\topacity: 0.7,\n\t\t\t},\n\t\t} );\n\t},\n\tunblock = ( $el ) => {\n\t\tif ( typeof $.fn.unblock === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$el.unblock();\n\t},\n\tserialize = ( $el, { formatName, filterItems } ) => {\n\t\tlet result = {},\n\t\t\tinputs = $el.find( ':input' ).not( '[disabled]' );\n\n\t\tif ( typeof filterItems === 'function' ) {\n\t\t\tinputs = inputs.filter( filterItems );\n\t\t}\n\n\t\tinputs.each( function () {\n\t\t\tlet t = $( this ),\n\t\t\t\tname = t.attr( 'name' ),\n\t\t\t\tvalue;\n\n\t\t\tif ( ! name ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// removes ending brackets, since are not needed\n\t\t\tname = name.replace( /^(.*)\\[]$/, '$1' );\n\n\t\t\t// offers additional name formatting from invoker\n\t\t\tif ( typeof formatName === 'function' ) {\n\t\t\t\tname = formatName( name );\n\t\t\t}\n\n\t\t\t// retrieve value, depending on input type\n\t\t\tif ( t.is( '[type=\"radio\"]' ) && ! t.is( ':checked' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = t.val();\n\n\t\t\t// if name is composite, try to recreate missing structure\n\t\t\tif ( -1 !== name.indexOf( '[' ) ) {\n\t\t\t\tconst components = name\n\t\t\t\t\t\t.split( '[' )\n\t\t\t\t\t\t.map( ( c ) => c.replace( /[\\[, \\]]/g, '' ) ),\n\t\t\t\t\tfirstComponent = components.shift(),\n\t\t\t\t\tnewItem = components\n\t\t\t\t\t\t.reverse()\n\t\t\t\t\t\t.reduce( ( res, key ) => ( { [ key ]: res } ), value );\n\n\t\t\t\tif ( typeof result[ firstComponent ] === 'undefined' ) {\n\t\t\t\t\tresult[ firstComponent ] = newItem;\n\t\t\t\t} else {\n\t\t\t\t\tresult[ firstComponent ] = $.extend(\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\tresult[ firstComponent ],\n\t\t\t\t\t\tnewItem\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// else simply append value to result object\n\t\t\telse {\n\t\t\t\tresult[ name ] = value;\n\t\t\t}\n\t\t} );\n\n\t\treturn result;\n\t},\n\tremoveHierarchyFromString = ( value ) => {\n\t\treturn value\n\t\t\t.replace( /^(.*>)([^>]+)$/, '$2' )\n\t\t\t.replace( '&amp;', '&' )\n\t\t\t.trim();\n\t};\n\nexport { $, $body, block, unblock, serialize, removeHierarchyFromString };\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $, $body, block, unblock } from '../globals.js';\n\nexport default class YITH_WCAN_Filter {\n\t// currently executing xhr\n\txhr = null;\n\n\t// flag set during ajax call handling\n\tdoingAjax = false;\n\n\t// register original url search param\n\toriginalSearch = location.search;\n\n\t// flag set once init has executed\n\tinitialized = false;\n\n\t// flag set when page has at least one active filter.\n\tfiltered = false;\n\n\t// init object\n\tconstructor() {\n\t\tthis.initPopState();\n\t\tthis.initialized = true;\n\t}\n\n\t// init page reload when popstate event alter filters\n\tinitPopState() {\n\t\tif ( ! yith_wcan_shortcodes.reload_on_back ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.pushUrlToHistory( window.location, document.title, null, true );\n\n\t\t$( window ).on( 'popstate', function () {\n\t\t\tif ( ! window.history.state?._yithWcan ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twindow.location.reload( true );\n\t\t} );\n\t}\n\n\t// execute call to filter products in current view\n\tdoFilter( filters, target, preset ) {\n\t\tlet targetUrl,\n\t\t\t$target = target ? $( target ) : $( 'body' ),\n\t\t\tcustomFilters;\n\n\t\t// filter properties\n\t\tcustomFilters = $( document ).triggerHandler(\n\t\t\t'yith_wcan_filters_parameters',\n\t\t\t[ filters ]\n\t\t);\n\n\t\tif ( !! customFilters ) {\n\t\t\tfilters = customFilters;\n\t\t}\n\n\t\t// block elements before filtering\n\t\t$target && this.block( $target );\n\n\t\t// calculate target url\n\t\ttargetUrl = this.buildUrl( filters );\n\n\t\t// if no ajax, simply change page url\n\t\tif ( ! yith_wcan_shortcodes.ajax_filters ) {\n\t\t\tthis.pushUrlToHistory( targetUrl, document.title, filters );\n\n\t\t\twindow.location = targetUrl;\n\t\t\treturn;\n\t\t}\n\n\t\t// start doing ajax\n\t\tthis.doingAjax = true;\n\n\t\treturn this._doAjax( targetUrl ).done( ( response ) => {\n\t\t\ttargetUrl = this.searchAlternativeUrl( response, targetUrl );\n\n\t\t\tthis._beforeFilter( response, filters );\n\n\t\t\tthis.refreshFragments( target, preset, response );\n\t\t\tthis.pushUrlToHistory( targetUrl, response.pageTitle, filters );\n\t\t\tthis.originalSearch = location.search;\n\n\t\t\t$target && this.unblock( $target );\n\n\t\t\tthis._afterFilter( response, filters );\n\n\t\t\tthis.doingAjax = false;\n\t\t} );\n\t}\n\n\t// actions performed before filter\n\t_beforeFilter( response, filters ) {\n\t\t$( document ).trigger( 'yith-wcan-ajax-loading', [\n\t\t\tresponse,\n\t\t\tfilters,\n\t\t] );\n\n\t\tyith_wcan_shortcodes.query_vars = filters;\n\t}\n\n\t// actions performed after filter\n\t_afterFilter( response, filters ) {\n\t\t$( '.woocommerce-ordering' ).on(\n\t\t\t'change',\n\t\t\t'select.orderby',\n\t\t\tfunction () {\n\t\t\t\t$( this ).closest( 'form' ).submit();\n\t\t\t}\n\t\t);\n\n\t\tthis.filtered = filters && !! Object.keys( filters ).length;\n\t\tthis.filtered\n\t\t\t? $body.addClass( 'filtered' )\n\t\t\t: $body.removeClass( 'filtered' );\n\n\t\t$( window ).trigger( 'scroll' );\n\n\t\t$( document )\n\t\t\t.trigger( 'yith-wcan-ajax-filtered', [ response, filters ] )\n\t\t\t.trigger( 'yith_wcwl_reload_after_ajax' );\n\t}\n\n\t// build url to show\n\tbuildUrl( filters ) {\n\t\tlet queryParam = yith_wcan_shortcodes.query_param,\n\t\t\tparams = {},\n\t\t\tlocation = window.location,\n\t\t\turl = !! yith_wcan_shortcodes.base_url\n\t\t\t\t? yith_wcan_shortcodes.base_url\n\t\t\t\t: location?.origin + location?.pathname,\n\t\t\tsearch = '',\n\t\t\tself = this;\n\n\t\tconst haveFilters =\n\t\t\ttypeof filters === 'object' && Object.keys( filters ).length;\n\n\t\t// remove filter session from current url, if any\n\t\tif ( !! yith_wcan_shortcodes.session_param ) {\n\t\t\turl = url.replace(\n\t\t\t\tnew RegExp(\n\t\t\t\t\t'/' + yith_wcan_shortcodes.session_param + '/[^/]*/'\n\t\t\t\t),\n\t\t\t\t''\n\t\t\t);\n\t\t}\n\n\t\tif ( haveFilters ) {\n\t\t\tparams[ queryParam ] = 1;\n\t\t}\n\n\t\tif ( !! this.originalSearch ) {\n\t\t\tconst searchParams = this.originalSearch\n\t\t\t\t.replace( '?', '' )\n\t\t\t\t.split( '&' )\n\t\t\t\t.reduce( ( a, v ) => {\n\t\t\t\t\tconst items = v.split( '=' );\n\n\t\t\t\t\tif ( items.length === 2 ) {\n\t\t\t\t\t\tif ( this.isFilterParam( items[ 0 ] ) ) {\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ta[ items[ 0 ] ] = items[ 1 ];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn a;\n\t\t\t\t}, {} );\n\n\t\t\tparams = $.extend( params, searchParams );\n\t\t}\n\n\t\tif ( haveFilters ) {\n\t\t\tparams = $.extend( params, filters );\n\t\t}\n\n\t\tsearch = Object.keys( params )\n\t\t\t.reduce( function ( a, i ) {\n\t\t\t\tconst v = params[ i ];\n\n\t\t\t\tif ( ! v || ! i ) {\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\n\t\t\t\ta += self._cleanParam( i ) + '=' + self._cleanParam( v ) + '&';\n\n\t\t\t\treturn a;\n\t\t\t}, '?' )\n\t\t\t.replace( /&$/g, '' )\n\t\t\t.replace( /%2B/g, '+' )\n\t\t\t.replace( /%2C/g, ',' );\n\n\t\tif ( search.length > 1 ) {\n\t\t\turl += search;\n\t\t}\n\n\t\treturn url;\n\t}\n\n\t// retrieves alternative sharing url in response body\n\tsearchAlternativeUrl( response, defaultUrl = '' ) {\n\t\tlet url = defaultUrl,\n\t\t\tmatches;\n\n\t\tif ( -1 === response.indexOf( 'yith_wcan:sharing_url' ) ) {\n\t\t\treturn url;\n\t\t}\n\n\t\tmatches = response.match(\n\t\t\t/<meta name=\"yith_wcan:sharing_url\" content=\"([^\"]*)\">/\n\t\t);\n\t\turl = matches && 1 in matches ? matches[ 1 ] : url;\n\n\t\treturn url;\n\t}\n\n\t// push url to browser history\n\tpushUrlToHistory( url, title, filters, current ) {\n\t\tif (\n\t\t\t! yith_wcan_shortcodes.change_browser_url ||\n\t\t\tnavigator.userAgent.match( /msie/i )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet method = 'pushState';\n\n\t\tif ( !! current ) {\n\t\t\tmethod = 'replaceState';\n\t\t}\n\n\t\twindow.history[ method ](\n\t\t\t{\n\t\t\t\t_yithWcan: true,\n\t\t\t\tpageTitle: title,\n\t\t\t\tfilters,\n\t\t\t},\n\t\t\t'',\n\t\t\turl\n\t\t);\n\t}\n\n\t// replaces elements in the page with refreshed ones\n\trefreshFragments( target, preset, response ) {\n\t\tconst responseDom = document.createElement( 'html' ),\n\t\t\t$response = $( responseDom );\n\n\t\tresponseDom.innerHTML = response;\n\n\t\tif ( target ) {\n\t\t\tlet $preset = $( preset ),\n\t\t\t\t$target = $( target ),\n\t\t\t\t$destination;\n\n\t\t\tif ( $preset.length ) {\n\t\t\t\t$destination = $response.find( preset );\n\n\t\t\t\tif ( $destination.length ) {\n\t\t\t\t\t$preset.replaceWith( $destination.first() );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( $target.length ) {\n\t\t\t\t$destination = $response.find( target );\n\n\t\t\t\tif ( $destination.length ) {\n\t\t\t\t\t$target.replaceWith( $destination.first() );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst content = $( yith_wcan_shortcodes.content );\n\n\t\t\tif ( content.length ) {\n\t\t\t\tcontent.replaceWith(\n\t\t\t\t\t$response.find( yith_wcan_shortcodes.content )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t$( 'body' ).replaceWith( $response.find( 'body' ) );\n\t\t\t}\n\t\t}\n\n\t\t$( document ).trigger( 'yith_wcan_init_shortcodes' );\n\t}\n\n\t// clean url parameters\n\t_cleanParam( param ) {\n\t\tif (\n\t\t\t! yith_wcan_shortcodes?.process_sanitize ||\n\t\t\tyith_wcan_shortcodes?.skip_sanitize\n\t\t) {\n\t\t\treturn param;\n\t\t}\n\n\t\treturn encodeURIComponent( param );\n\t}\n\n\t// executes Ajax calls\n\t_doAjax( url, params ) {\n\t\tif ( this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\n\t\tparams = $.extend(\n\t\t\t{\n\t\t\t\turl,\n\t\t\t\theaders: {\n\t\t\t\t\t'X-YITH-WCAN': 1,\n\t\t\t\t},\n\t\t\t},\n\t\t\tparams\n\t\t);\n\n\t\tthis.xhr = $.ajax( params );\n\n\t\treturn this.xhr;\n\t}\n\n\t// block dom elements\n\tblock( $el ) {\n\t\treturn block( $el );\n\t}\n\n\t// unblock dom elements\n\tunblock( $el ) {\n\t\treturn unblock( $el );\n\t}\n\n\t// checks if param is one used by layared nav to filter products.\n\tisFilterParam( param ) {\n\t\tlet supportedParams = [\n\t\t\t\t'rating_filter',\n\t\t\t\t'min_price',\n\t\t\t\t'max_price',\n\t\t\t\t'price_ranges',\n\t\t\t\t'onsale_filter',\n\t\t\t\t'instock_filter',\n\t\t\t\t'featured_filter',\n\t\t\t\t'orderby',\n\t\t\t\t'product-page',\n\t\t\t\tyith_wcan_shortcodes.query_param,\n\t\t\t],\n\t\t\tcustomParams;\n\n\t\t// filter properties\n\t\tcustomParams = $( document ).triggerHandler(\n\t\t\t'yith_wcan_supported_filters_parameters',\n\t\t\t[ supportedParams ]\n\t\t);\n\n\t\tif ( !! customParams ) {\n\t\t\tsupportedParams = customParams;\n\t\t}\n\n\t\tsupportedParams = supportedParams.concat(\n\t\t\tyith_wcan_shortcodes.supported_taxonomies.map( ( i ) =>\n\t\t\t\ti.replace( 'pa_', 'filter_' )\n\t\t\t)\n\t\t);\n\n\t\tif ( -1 !== supportedParams.indexOf( param ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( -1 !== param.indexOf( 'filter_' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( -1 !== param.indexOf( 'query_type_' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../globals.js';\n\nexport default class YITH_WCAN_Filter_Labels {\n\t// current label set\n\t$label_set = null;\n\n\t// labels of current set\n\t$labels = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current label set\n\t\tthis.$label_set = el;\n\n\t\tthis._initLabels();\n\n\t\tthis.$label_set.data( 'filter_labels', this ).addClass( 'enhanced' );\n\t}\n\n\t// init labels\n\t_initLabels() {\n\t\tconst self = this;\n\n\t\tthis.getLabels().each( function () {\n\t\t\tconst $label = $( this );\n\n\t\t\tself._initLabel( $label );\n\t\t} );\n\t}\n\n\t// init label\n\t_initLabel( $label ) {\n\t\t$label.on( 'click', ( ev ) => {\n\t\t\tif ( this.disableLabel( $label ) ) {\n\t\t\t\tev.preventDefault();\n\t\t\t}\n\t\t} );\n\t}\n\n\t// get labels\n\tgetLabels() {\n\t\tif ( false === this.$labels ) {\n\t\t\tthis.$labels = this.$label_set.find( '.active-filter-label' );\n\t\t}\n\n\t\treturn this.$labels;\n\t}\n\n\t// disable filter\n\tdisableLabel( $label ) {\n\t\tconst properties = $label.data( 'filters' );\n\t\tlet result = false;\n\n\t\t// search for preset\n\t\t$( '.yith-wcan-filters' ).each( function () {\n\t\t\tconst preset = $( this ).data( 'preset' );\n\n\t\t\tresult =\n\t\t\t\tresult ||\n\t\t\t\tpreset.deactivateFilterByProperties( properties, true );\n\t\t} );\n\n\t\treturn result;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../globals.js';\n\nexport default class YITH_WCAN_Reset_Button {\n\t// current button\n\t$reset = null;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current button\n\t\tthis.$reset = el;\n\n\t\tthis.$reset.on( 'click', function ( ev ) {\n\t\t\tev.preventDefault();\n\n\t\t\t$( '.yith-wcan-filters' ).each( function () {\n\t\t\t\tconst preset = $( this ).data( 'preset' );\n\n\t\t\t\tpreset.deactivateAllFilters( true );\n\t\t\t\tpreset.closeModal();\n\t\t\t} );\n\t\t} );\n\n\t\tthis.$reset.data( 'reset', this ).addClass( 'enhanced' );\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../globals.js';\n\nexport default class YITH_WCAN_Modal_Opener {\n\t// current button\n\t$button = null;\n\n\t// YITH_WCAN_Preset object\n\tpreset = null;\n\n\t// preset dom node\n\t$preset = null;\n\n\t// is mobile flag\n\tisMobile = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current button\n\t\tthis.$button = el;\n\n\t\tthis._initPreset();\n\t\tthis._initResponsive();\n\t\tthis._initActions();\n\n\t\tthis.$button.data( 'modalOpener', this ).addClass( 'enhanced' );\n\t}\n\n\t// search for related preset\n\t_initPreset() {\n\t\tlet target = this.$button.data( 'target' ),\n\t\t\t$target;\n\n\t\tif ( target ) {\n\t\t\t$target = $( `#${ target }` );\n\t\t} else {\n\t\t\t$target = $( '.yith-wcan-filters' );\n\t\t}\n\n\t\tif ( ! $target.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$preset = $target.first();\n\t\tthis.preset = this.$preset.data( 'preset' );\n\t}\n\n\t// init responsive\n\t_initResponsive() {\n\t\tif ( ! yith_wcan_shortcodes.modal_on_mobile || ! this.preset ) {\n\t\t\tthis.$button.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst media = window.matchMedia(\n\t\t\t`(max-width: ${ yith_wcan_shortcodes.mobile_media_query }px)`\n\t\t);\n\n\t\t$( window )\n\t\t\t.on( 'resize', () => {\n\t\t\t\tconst isMobile = !! media.matches;\n\n\t\t\t\tif ( isMobile !== this.isMobile ) {\n\t\t\t\t\tthis.isMobile = isMobile;\n\t\t\t\t\tthis._afterLayoutChange();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.resize();\n\t}\n\n\t// init actions\n\t_initActions() {\n\t\tif ( ! this.$preset?.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst self = this;\n\n\t\tthis.$button.on( 'click', function ( ev ) {\n\t\t\tev.preventDefault();\n\n\t\t\tself.preset.openModal();\n\t\t} );\n\t}\n\n\t// hide/show button when needed\n\t_afterLayoutChange() {\n\t\tthis.isMobile ? this.$button.show() : this.$button.hide();\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../globals.js';\n\nexport default class YITH_WCAN_Dropdown {\n\t// current button\n\t$originalSelect = null;\n\n\t// list of current items.\n\t_items = [];\n\n\t// main element\n\t$_main = null;\n\n\t// label element\n\t$_label = null;\n\n\t// dropdown\n\t$_dropdown = null;\n\n\t// search input\n\t$_search = null;\n\n\t// show more link\n\t$_showMore = null;\n\n\t// items list\n\t$_items = null;\n\n\t// whether select should paginate.\n\tpaginate = false;\n\n\t// whether select has more items than those shown.\n\thasMore = false;\n\n\t// whether items list needs update.\n\tneedsRefresh = true;\n\n\t// whether select is multiple\n\tmultiple = false;\n\n\t// current page\n\tcurrentPage = 1;\n\n\t// options\n\toptions = {};\n\n\t// init object\n\tconstructor( el, opts ) {\n\t\tthis.$originalSelect = el;\n\n\t\tif ( ! this.$originalSelect.is( 'select' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst defaultPerPage = this.$originalSelect.data( 'per_page' ),\n\t\t\tdefaultOrder = this.$originalSelect.data( 'order' ),\n\t\t\tdefaultAll = this.$originalSelect.data( 'all-label' ),\n\t\t\tdefaults = {\n\t\t\t\tshowSearch: this.$originalSelect.data( 'show_search' ),\n\t\t\t\tpaginate: this.$originalSelect.data( 'paginate' ),\n\t\t\t\tperPage: defaultPerPage ? defaultPerPage : 10,\n\t\t\t\thasMore: false,\n\t\t\t\torder: defaultOrder ? defaultOrder : 'ASC',\n\t\t\t\tgetElements: null,\n\t\t\t\tlabels: {\n\t\t\t\t\temptyLabel: defaultAll\n\t\t\t\t\t\t? defaultAll\n\t\t\t\t\t\t: yith_wcan_shortcodes.labels?.empty_option,\n\t\t\t\t\tsearchPlaceholder:\n\t\t\t\t\t\tyith_wcan_shortcodes.labels?.search_placeholder,\n\t\t\t\t\tnoItemsFound: yith_wcan_shortcodes.labels?.no_items,\n\t\t\t\t\tshowMore: yith_wcan_shortcodes.labels?.show_more,\n\t\t\t\t},\n\t\t\t};\n\n\t\tthis.multiple = this.$originalSelect.prop( 'multiple' );\n\t\tthis.options = $.extend( defaults, opts );\n\t\tthis.paginate = this.options.paginate || false;\n\t\tthis.hasMore = this.options.hasMore || false;\n\n\t\tthis._hideSelect();\n\t\tthis._initTemplate();\n\t\tthis._initActions();\n\n\t\tthis.$originalSelect.data( 'dropdown', this ).addClass( 'enhanced' );\n\t}\n\n\t// hide select\n\t_hideSelect() {\n\t\tthis.$originalSelect.hide();\n\t}\n\n\t// create dropdown\n\t_initTemplate() {\n\t\tconst $mainSpan = $( '<div/>', {\n\t\t\t\tclass: 'yith-wcan-dropdown closed',\n\t\t\t} ),\n\t\t\t$labelSpan = $( '<div/>', {\n\t\t\t\tclass: 'dropdown-label',\n\t\t\t\thtml: this.getLabel(),\n\t\t\t} ),\n\t\t\t$dropdownSpan = $( '<div>', {\n\t\t\t\tclass: 'dropdown-wrapper',\n\t\t\t} ),\n\t\t\t$matchingItemsList = $( '<ul/>', {\n\t\t\t\tclass: 'matching-items filter-items',\n\t\t\t} );\n\n\t\t$dropdownSpan.append( $matchingItemsList );\n\t\t$mainSpan.append( $labelSpan ).append( $dropdownSpan );\n\n\t\tif ( this.options.showSearch ) {\n\t\t\tthis._initSearchTemplate( $dropdownSpan );\n\t\t}\n\n\t\tif ( this.options.paginate ) {\n\t\t\tthis._initShowMoreTemplate( $dropdownSpan );\n\t\t}\n\n\t\tthis.$originalSelect.after( $mainSpan );\n\t\tthis.$_main = $mainSpan;\n\t\tthis.$_label = $labelSpan;\n\t\tthis.$_dropdown = $dropdownSpan;\n\t\tthis.$_items = $matchingItemsList;\n\t}\n\n\t// create search field\n\t_initSearchTemplate( $dropdwonSpan ) {\n\t\tconst $container = $( '<div/>', {\n\t\t\t\tclass: 'search-field-container',\n\t\t\t} ),\n\t\t\t$search = $( '<input/>', {\n\t\t\t\tname: 's',\n\t\t\t\tclass: 'search-field',\n\t\t\t\ttype: 'search',\n\t\t\t\tplaceholder: this.options.labels.searchPlaceholder,\n\t\t\t} ).attr( 'autocomplete', 'off' );\n\n\t\t$container.append( $search ).prependTo( $dropdwonSpan );\n\t\tthis.$_search = $search;\n\t}\n\n\t// create showMore field\n\t_initShowMoreTemplate( $dropdwonSpan ) {\n\t\tconst $showMore = $( '<a/>', {\n\t\t\tclass: 'show-more',\n\t\t\ttext: this.options.labels.showMore?.replace(\n\t\t\t\t'%d',\n\t\t\t\tthis.options.perPage\n\t\t\t),\n\t\t} );\n\n\t\t$showMore.on( 'click', this.loadNextPage.bind( this ) ).hide();\n\n\t\t$dropdwonSpan.append( $showMore );\n\t\tthis.$_showMore = $showMore;\n\t}\n\n\t// init actions performed over dropdown elements\n\t_initActions() {\n\t\tconst self = this;\n\n\t\t// main open event\n\t\tthis.$_main?.on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t\tself.toggleDropdown();\n\t\t} );\n\t\tthis.$_dropdown.on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t} );\n\n\t\t// search event\n\t\tthis.$_search?.on( 'keyup search change', () => {\n\t\t\tthis.paginate = false;\n\n\t\t\tthis._populateItems().then( () => {\n\t\t\t\tthis.needsRefresh = true;\n\t\t\t} );\n\t\t\treturn false;\n\t\t} );\n\n\t\t// select event\n\t\tthis.$_items.on( 'change', ':input', function () {\n\t\t\tlet $li = $( this ).closest( 'li' ),\n\t\t\t\tvalue = $li.data( 'value' ),\n\t\t\t\tisActive = false;\n\n\t\t\tif (\n\t\t\t\t$li.hasClass( 'disabled' ) &&\n\t\t\t\t! self.isValueSelected( value )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$li.toggleClass( 'active' );\n\t\t\tisActive = $li.hasClass( 'active' );\n\n\t\t\tself._changeItemStatus( value, isActive );\n\t\t} );\n\t\tthis.$_items.on( 'click', 'li:not(.checkbox) a', function ( ev ) {\n\t\t\tlet $li = $( this ).closest( 'li' ),\n\t\t\t\tvalue = $li.data( 'value' ),\n\t\t\t\tisActive = false;\n\n\t\t\tev.preventDefault();\n\n\t\t\tif (\n\t\t\t\t$li.hasClass( 'disabled' ) &&\n\t\t\t\t! self.isValueSelected( value )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$li.toggleClass( 'active' );\n\t\t\tisActive = $li.hasClass( 'active' );\n\n\t\t\tif ( isActive ) {\n\t\t\t\t$li.siblings().removeClass( 'active' );\n\t\t\t}\n\n\t\t\tself._changeItemStatus( value, isActive );\n\t\t} );\n\t\tthis.$_items.on( 'click', 'label > a', function ( ev ) {\n\t\t\tconst input = $( this ).parent().find( ':input' );\n\n\t\t\tev.preventDefault();\n\n\t\t\tif (\n\t\t\t\tinput.is( '[type=\"radio\"]' ) ||\n\t\t\t\tinput.is( '[type=\"checkbox\"]' )\n\t\t\t) {\n\t\t\t\tinput.prop( 'checked', ! input.prop( 'checked' ) );\n\t\t\t}\n\n\t\t\tinput.change();\n\t\t} );\n\n\t\t// select change\n\t\tthis.$originalSelect.on( 'change', ( ev, selfOriginated ) => {\n\t\t\tif ( selfOriginated ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.updateLabel();\n\t\t} );\n\n\t\t// close dropdown on external click; do this handler only once for any dropdown in the page\n\t\tif ( ! globalThis?.yith_wcan_dropdown_init ) {\n\t\t\t$( document ).on( 'click', this._closeAllDropdowns );\n\t\t\tglobalThis.yith_wcan_dropdown_init = true;\n\t\t}\n\t}\n\n\t// open dropdown\n\topenDropdown() {\n\t\tthis.$_main?.addClass( 'open' ).removeClass( 'closed' );\n\t\tthis._afterDropdownOpen();\n\t}\n\n\t// close dropdown\n\tcloseDropdown() {\n\t\tthis.$_main?.removeClass( 'open' ).addClass( 'closed' );\n\t}\n\n\t// close all dropdowns\n\t_closeAllDropdowns() {\n\t\tconst dropdowns = $( document )\n\t\t\t.find( 'select.enhanced' )\n\t\t\t.filter( function ( i, select ) {\n\t\t\t\tconst $el = $( select );\n\n\t\t\t\treturn !! $el.data( 'dropdown' );\n\t\t\t} );\n\n\t\tdropdowns.each( function () {\n\t\t\t$( this ).data( 'dropdown' ).closeDropdown();\n\t\t} );\n\t}\n\n\t// close other dropdowns\n\t_closeOtherDropdowns() {\n\t\tconst self = this,\n\t\t\tdropdowns = $( document )\n\t\t\t\t.find( 'select.enhanced' )\n\t\t\t\t.filter( function ( i, select ) {\n\t\t\t\t\tconst $el = $( select );\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t!! $el.data( 'dropdown' ) &&\n\t\t\t\t\t\t! $el.is( self.$originalSelect )\n\t\t\t\t\t);\n\t\t\t\t} );\n\n\t\tdropdowns.each( function () {\n\t\t\t$( this ).data( 'dropdown' ).closeDropdown();\n\t\t} );\n\t}\n\n\t// toggle dropdown\n\ttoggleDropdown() {\n\t\tthis.$_main?.toggleClass( 'open' ).toggleClass( 'closed' );\n\n\t\tif ( this.$_main?.hasClass( 'open' ) ) {\n\t\t\tthis._afterDropdownOpen();\n\t\t}\n\t}\n\n\t// perform operations after dropdown is open\n\t_afterDropdownOpen() {\n\t\tthis._closeOtherDropdowns();\n\n\t\tif ( this.$_search?.length ) {\n\t\t\tthis.$_search.val( '' );\n\t\t}\n\n\t\tthis._maybePopulateItems();\n\t}\n\n\tasync getItems( search ) {\n\t\tif ( ! this._items.length ) {\n\t\t\tconst $options = this.getOptions();\n\n\t\t\t$options.each( ( i, el ) => {\n\t\t\t\tconst t = $( el ),\n\t\t\t\t\tvalue = t.val(),\n\t\t\t\t\tlabel = t.html();\n\n\t\t\t\tthis._items.push( {\n\t\t\t\t\tvalue,\n\t\t\t\t\tlabel,\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\tlet items = await this.getMatchingElements( search );\n\t\tconst perPage = this.paginate ? this.options.perPage : 0;\n\n\t\tif ( perPage && items.length > perPage ) {\n\t\t\tthis.hasMore = true;\n\t\t\titems = items.slice( 0, perPage );\n\t\t}\n\n\t\treturn items;\n\t}\n\n\t// get elements\n\tgetMatchingElements( search ) {\n\t\tlet matchingElements = this._items,\n\t\t\tpromise;\n\n\t\tpromise = new Promise( ( resolve ) => {\n\t\t\tmatchingElements = search\n\t\t\t\t? matchingElements.filter( ( { label, value } ) => {\n\t\t\t\t\t\tconst regex = new RegExp( '.*' + search + '.*', 'i' );\n\t\t\t\t\t\treturn regex.test( value ) || regex.test( label );\n\t\t\t\t  } )\n\t\t\t\t: matchingElements;\n\n\t\t\t// then retrieve additional items\n\t\t\tif ( this.options.getElements ) {\n\t\t\t\t// we're expecting key => value pairs\n\t\t\t\tthis.options.getElements\n\t\t\t\t\t.call( this, search )\n\t\t\t\t\t.then( ( retrievedElements ) => {\n\t\t\t\t\t\tif ( retrievedElements ) {\n\t\t\t\t\t\t\t// reformat retrieved array\n\t\t\t\t\t\t\tretrievedElements = Object.keys(\n\t\t\t\t\t\t\t\tretrievedElements\n\t\t\t\t\t\t\t).reduce( ( a, i ) => {\n\t\t\t\t\t\t\t\tif ( !! retrievedElements[ i ].label ) {\n\t\t\t\t\t\t\t\t\ta.push( retrievedElements[ i ] );\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ta.push( {\n\t\t\t\t\t\t\t\t\tlabel: retrievedElements[ i ],\n\t\t\t\t\t\t\t\t\tvalue: i,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, [] );\n\n\t\t\t\t\t\t\t// merge found results with options\n\t\t\t\t\t\t\tmatchingElements = [\n\t\t\t\t\t\t\t\t...matchingElements,\n\t\t\t\t\t\t\t\t...retrievedElements,\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve( this._formatItems( matchingElements ) );\n\t\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tresolve( this._formatItems( matchingElements ) );\n\t\t\t}\n\t\t} );\n\n\t\treturn promise;\n\t}\n\n\t// format items as key/value pairs for further processing\n\t_formatItems( items ) {\n\t\tlet indexes = [];\n\n\t\t// remove duplicates and sort array of results\n\t\treturn items.filter( ( { value, label } ) => {\n\t\t\tif ( -1 === indexes.indexOf( value ) ) {\n\t\t\t\tindexes.push( value );\n\n\t\t\t\t// checks if select has a related option.\n\t\t\t\tif ( ! this.getOptionByValue( value ).length ) {\n\t\t\t\t\tthis.$originalSelect.append(\n\t\t\t\t\t\t`<option class=\"filter-item\" value=\"${ value }\">${ label }</option>`\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// add item to final array of elements.\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// item should not be included in the final set.\n\t\t\treturn false;\n\t\t} );\n\t}\n\n\t// generate item to append to items list\n\t_generateItem( value, label ) {\n\t\tlet active = this.isValueSelected( value ),\n\t\t\toption = this.getOptionByValue( value ),\n\t\t\t$item = $( '<li/>', {\n\t\t\t\t'data-value': value,\n\t\t\t\tclass: option.length ? option.attr( 'class' ) : '',\n\t\t\t} ),\n\t\t\t$anchor;\n\n\t\tif ( option.length ) {\n\t\t\tconst template = option.data( 'template' ),\n\t\t\t\tcount = option.data( 'count' );\n\n\t\t\tlabel = template ? template : label;\n\n\t\t\tif ( !! count ) {\n\t\t\t\tlabel += count;\n\t\t\t}\n\t\t}\n\n\t\t$anchor = $( '<a/>', {\n\t\t\thref: option.length ? option.data( 'filter_url' ) : '#',\n\t\t\thtml: label,\n\t\t\trel: 'nofollow',\n\t\t\t'data-title': option.length ? option.data( 'title' ) : '',\n\t\t} );\n\n\t\tif ( this.multiple ) {\n\t\t\tconst $checkbox = $( '<input/>', {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue,\n\t\t\t\t} ),\n\t\t\t\t$label = $( '<label>' );\n\n\t\t\t$checkbox.prop( 'checked', active );\n\t\t\t$label.prepend( $checkbox ).append( $anchor );\n\t\t\t$item.append( $label ).addClass( 'checkbox' );\n\t\t} else {\n\t\t\t$item.append( $anchor );\n\t\t}\n\n\t\tactive ? $item.addClass( 'active' ) : $item.removeClass( 'active' );\n\n\t\treturn $item;\n\t}\n\n\t_maybePopulateItems() {\n\t\tif ( ! this.needsRefresh ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._populateItems();\n\t}\n\n\t_populateItems() {\n\t\tconst search = this.$_search?.length ? this.$_search.val() : false;\n\n\t\treturn this.getItems( search ).then( ( items ) => {\n\t\t\tthis._emptyItems();\n\t\t\tthis._hideLoadMore();\n\n\t\t\tthis.$_items.append(\n\t\t\t\titems.map( ( { label, value } ) =>\n\t\t\t\t\tthis._generateItem( value, label )\n\t\t\t\t)\n\t\t\t);\n\t\t\tthis.$originalSelect.trigger( 'yith_wcan_dropdown_updated' );\n\t\t\tthis.needsRefresh = false;\n\n\t\t\tif ( this.paginate && this.hasMore ) {\n\t\t\t\tthis._showLoadMore();\n\t\t\t}\n\t\t} );\n\t}\n\n\t// load next page of items\n\tasync loadNextPage() {\n\t\tthis.paginate = false;\n\n\t\tthis._populateItems().then( () => {\n\t\t\tthis.hasMore = false;\n\t\t} );\n\t}\n\n\t// set an item as active\n\t_selectItem( value ) {\n\t\treturn this._changeItemStatus( value, true );\n\t}\n\n\t// disable an item\n\t_deselectItem( value ) {\n\t\treturn this._changeItemStatus( value, false );\n\t}\n\n\t// change item status\n\t_changeItemStatus( value, status ) {\n\t\tconst $option = this.$originalSelect.find(\n\t\t\t`option[value=\"${ value }\"]`\n\t\t);\n\n\t\tif ( $option.length ) {\n\t\t\t$option.prop( 'selected', status );\n\n\t\t\t( ! yith_wcan_shortcodes.instant_filters && this.multiple ) ||\n\t\t\t\tthis.closeDropdown();\n\t\t\tthis.updateLabel();\n\n\t\t\tthis.$originalSelect.trigger( 'change', [ true ] );\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// empty items list\n\t_emptyItems() {\n\t\tthis.$_items.html( '' );\n\t}\n\n\t// show \"Load more\" link\n\t_showLoadMore() {\n\t\tthis.$_showMore.show();\n\t}\n\n\t// hide \"Load more\" link\n\t_hideLoadMore() {\n\t\tthis.$_showMore.hide();\n\t}\n\n\t// returns select label\n\tgetLabel() {\n\t\treturn this.hasSelectedValues()\n\t\t\t? this.getSelectedLabels().join( ', ' )\n\t\t\t: this.options.labels.emptyLabel;\n\t}\n\n\t// update label to match new selection\n\tupdateLabel() {\n\t\tconst label = this.getLabel();\n\n\t\tthis.$_label?.html( label );\n\t}\n\n\t// returns select options\n\tgetOptions() {\n\t\treturn this.$originalSelect.find( 'option' );\n\t}\n\n\t// checks whether select has selected values\n\thasSelectedValues() {\n\t\treturn this.getSelectedOptions().length;\n\t}\n\n\t// checks whether a value is selected\n\tisValueSelected( value ) {\n\t\tconst found = this.getSelectedValues().indexOf( value.toString() );\n\n\t\treturn -1 !== found;\n\t}\n\n\t// retrieve selected options\n\tgetSelectedOptions() {\n\t\treturn this.$originalSelect.find( 'option' ).filter( ':selected' );\n\t}\n\n\t// retrieves an option node by value\n\tgetOptionByValue( value ) {\n\t\treturn this.$originalSelect.find( `option[value=\"${ value }\"]` );\n\t}\n\n\t// retrieve labels for selected options\n\tgetSelectedLabels() {\n\t\tconst labels = [];\n\n\t\tthis.getSelectedOptions().each( function () {\n\t\t\tlet $option = $( this ),\n\t\t\t\ttemplate = $option.data( 'template' );\n\n\t\t\ttemplate = template\n\t\t\t\t? template\n\t\t\t\t: $option.html().replace( /\\([0-9]*\\)/, '' );\n\n\t\t\tlabels.push( template );\n\t\t} );\n\n\t\treturn labels;\n\t}\n\n\t// retrieve values for selected options\n\tgetSelectedValues() {\n\t\tconst values = [];\n\n\t\tthis.getSelectedOptions().each( function () {\n\t\t\tvalues.push( $( this ).val() );\n\t\t} );\n\n\t\treturn values;\n\t}\n\n\tdestroy() {\n\t\t// TBD\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $, block, unblock } from '../globals.js';\nimport YITH_WCAN_Dropdown from './yith-wcan-dropdown';\n\nexport default class YITH_WCAN_Preset {\n\t// main preset node\n\tpreset = false;\n\t$preset = false;\n\n\t// target of the filter, if any\n\ttarget = false;\n\t$target = false;\n\n\t// filters node\n\t$filters = false;\n\n\t// filter button\n\t$filterButtons = false;\n\n\t// nodes created just for modal layout\n\tmodalElements = {};\n\n\t// retains current status of filters\n\tactiveFilters = false;\n\n\t// mobile flag\n\tisMobile = false;\n\n\t// slider timeout\n\tsliderTimeout = false;\n\n\t// registers when status has changed\n\toriginalFilters = null;\n\tdirty = false;\n\n\t// promise resolved when all async loading is complete.\n\tloaded;\n\n\t// flag to disable filtering\n\tinhibitFilters = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// main preset node\n\t\tthis.preset = '#' + el.attr( 'id' );\n\t\tthis.$preset = el;\n\n\t\t// target of the filter, if any\n\t\tthis.target = this.$preset.data( 'target' );\n\t\tthis.$target = this.target ? $( this.target ) : false;\n\n\t\tthis._regiterStatus();\n\t\tthis._initFilterButton();\n\t\tthis._initFilters();\n\t\tthis._initResponsive();\n\t\tthis._initActions();\n\n\t\tthis.$preset\n\t\t\t.data( 'preset', this )\n\t\t\t.addClass( 'enhanced' )\n\t\t\t.trigger( 'yith_wcan_preset_initialized', [ this ] );\n\t}\n\n\t// init filters\n\t_initFilters() {\n\t\tconst filters = this.getFilters()\n\t\t\t.get()\n\t\t\t.map( ( filter ) => this._initFilter( $( filter ) ) );\n\n\t\tthis.loaded = Promise.all( filters );\n\n\t\tthis.maybeShowClearAllFilters();\n\t}\n\n\t// init filter button\n\t_initFilterButton() {\n\t\tthis.$filterButtons = this.$preset.find( '.apply-filters' );\n\n\t\tif ( ! this.$filterButtons.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// manage filter button\n\t\tthis.$filterButtons\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\t\t\t\tthis.filter();\n\t\t\t} )\n\t\t\t.hide();\n\t}\n\n\t// init generic actions\n\t_initActions() {\n\t\tthis.$preset.find( 'form' ).on( 'submit', ( ev ) => {\n\t\t\tev.preventDefault();\n\t\t} );\n\t}\n\n\t// init responsive\n\t_initResponsive() {\n\t\tif ( ! yith_wcan_shortcodes.modal_on_mobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst media = window.matchMedia(\n\t\t\t`(max-width: ${ yith_wcan_shortcodes.mobile_media_query }px)`\n\t\t);\n\n\t\t$( window )\n\t\t\t.on( 'resize', () => {\n\t\t\t\tconst isMobile = !! media.matches;\n\n\t\t\t\tif ( isMobile !== this.isMobile ) {\n\t\t\t\t\tthis.isMobile = isMobile;\n\t\t\t\t\tthis._afterLayoutChange();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.resize();\n\t}\n\n\t// init filter\n\t_initFilter( $filter ) {\n\t\tconst self = this,\n\t\t\thandleChange = function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$currentFilter = t.closest( '.yith-wcan-filter' ),\n\t\t\t\t\tmultiple = $currentFilter.length\n\t\t\t\t\t\t? 'yes' === $currentFilter.data( 'multiple' )\n\t\t\t\t\t\t: false,\n\t\t\t\t\t$item = t.closest( '.filter-item' ),\n\t\t\t\t\t$items = $item.length\n\t\t\t\t\t\t? $currentFilter.find( '.filter-item' ).not( $item )\n\t\t\t\t\t\t: [];\n\n\t\t\t\tif ( $currentFilter.is( '.filter-price-slider' ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tev.preventDefault();\n\n\t\t\t\t$items.length &&\n\t\t\t\t\t! multiple &&\n\t\t\t\t\t$items\n\t\t\t\t\t\t.removeClass( 'active' )\n\t\t\t\t\t\t.children( 'label' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.parent( '.checked' )\n\t\t\t\t\t\t.removeClass( 'checked' );\n\t\t\t\t$item.length && $item.toggleClass( 'active' );\n\n\t\t\t\t// reset active filters.\n\t\t\t\tself.activeFilters = false;\n\n\t\t\t\tself.maybeFilter( $filter );\n\t\t\t\tself.maybeToggleClearAllFilters();\n\t\t\t\tself.maybeToggleClearFilter( $currentFilter );\n\t\t\t};\n\n\t\t// load filter when needed and then init it.\n\t\t// eslint-disable-next-line no-shadow\n\t\treturn this._maybeLoadFilter( $filter ).then( ( $filter ) => {\n\t\t\t// handle filter activation/deactivation by click on label (no input involved)\n\t\t\t$filter.on( 'click', 'a', function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\t\tif (\n\t\t\t\t\t! $item.length ||\n\t\t\t\t\t$item.is( '.checkbox' ) ||\n\t\t\t\t\t$item.is( '.radio' )\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleChange.call( this, ev );\n\t\t\t} );\n\n\t\t\t// handle filter activation/deactivation from input change\n\t\t\t$filter.on( 'change', ':input', function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\t\tt.prop( 'checked', false );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\thandleChange.call( this, ev );\n\t\t\t} );\n\n\t\t\t// handle filter activation/deactivation by click on label (there is an input whose state can be switched)\n\t\t\t$filter.on( 'click', 'label > a', function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst $input = t.parent().find( ':input' );\n\n\t\t\t\tif (\n\t\t\t\t\t$input.is( '[type=\"radio\"]' ) ||\n\t\t\t\t\t$input.is( '[type=\"checkbox\"]' )\n\t\t\t\t) {\n\t\t\t\t\t$input.prop( 'checked', ! $input.prop( 'checked' ) );\n\t\t\t\t}\n\n\t\t\t\t$input.change();\n\t\t\t} );\n\n\t\t\t// init children items, such as tooltip, dropdowns, etc.\n\t\t\tthis._initFilterChildren( $filter );\n\n\t\t\t// init clear anchors\n\t\t\tthis.maybeShowClearFilter( $filter );\n\n\t\t\treturn $filter;\n\t\t} );\n\t}\n\n\t// performs additional operations after filter init, such as adding tooltip, collapsable handles, custom dropdowns, etc.\n\t_initFilterChildren( $filter ) {\n\t\t// init tooltip\n\t\tthis._initTooltip( $filter );\n\n\t\t// init price slider\n\t\tthis._initPriceSlider( $filter );\n\n\t\t// init dropdown\n\t\tthis._initDropdown( $filter );\n\n\t\t// init collapsable\n\t\tthis._initCollapsable( $filter );\n\n\t\t// init show more link\n\t\tthis._initShowMore( $filter );\n\n\t\t// init custom inputs\n\t\tif ( this.$preset?.hasClass( 'custom-style' ) ) {\n\t\t\tthis._initCustomInput( $filter );\n\t\t\t$filter.on( 'yith_wcan_dropdown_updated', ( ev ) => {\n\t\t\t\tconst $dropdown = $( ev.target ),\n\t\t\t\t\t$current = $dropdown.closest( '.yith-wcan-filter' );\n\n\t\t\t\tthis._initCustomInput( $current );\n\t\t\t} );\n\t\t}\n\t}\n\n\t// load filter via AJAX\n\t_maybeLoadFilter( $filter ) {\n\t\t// if filter doesn't require loading, return it as Promise resolve value.\n\t\tif ( ! $filter.hasClass( 'filter-placeholder' ) ) {\n\t\t\treturn Promise.resolve( $filter );\n\t\t}\n\n\t\t// otherwise load filter via AJAX.\n\t\treturn new Promise( ( resolve ) => {\n\t\t\t$.ajax( {\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: yith_wcan_shortcodes.base_url,\n\t\t\t\tdata: {\n\t\t\t\t\t'wc-ajax': 'yith_wcan_render_filter',\n\t\t\t\t\t_preset_id: this.getId(),\n\t\t\t\t\t_filter_id: $filter.data( 'filter-id' ),\n\t\t\t\t\tsecurity: yith_wcan_shortcodes.nonces?.render_filter,\n\t\t\t\t\t...this.originalFilters,\n\t\t\t\t},\n\t\t\t} ).then( ( data ) =>\n\t\t\t\tresolve(\n\t\t\t\t\tthis._loadFilter(\n\t\t\t\t\t\t$filter,\n\t\t\t\t\t\tdata.success ? data?.data?.html : ''\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t} );\n\t}\n\n\t// replace placeholder with actual filter template.\n\t_loadFilter( $filter, filterHTML ) {\n\t\tif ( ! filterHTML ) {\n\t\t\treturn $filter.remove();\n\t\t}\n\n\t\tconst $newFilter = $( filterHTML );\n\t\t$filter.replaceWith( $newFilter );\n\n\t\t// old filters are outdated, clear them until next .getFilters()\n\t\tthis.$filters = false;\n\n\t\treturn $newFilter;\n\t}\n\n\t// init tooltip\n\t_initTooltip( $filter, position ) {\n\t\t$filter.find( '[data-title]' ).each( function () {\n\t\t\tconst t = $( this );\n\n\t\t\tif ( t.hasClass( 'tooltip-added' ) || ! t.data( 'title' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tt.on( 'mouseenter', function () {\n\t\t\t\tlet th = $( this ),\n\t\t\t\t\ttooltip = null,\n\t\t\t\t\twrapperWidth = th.outerWidth(),\n\t\t\t\t\tleft = 0,\n\t\t\t\t\twidth = 0;\n\n\t\t\t\tif (\n\t\t\t\t\t! position ||\n\t\t\t\t\t( 'top' !== position && 'right' !== position )\n\t\t\t\t) {\n\t\t\t\t\tconst container = th.closest( '.filter-item' );\n\n\t\t\t\t\tposition =\n\t\t\t\t\t\tcontainer.hasClass( 'color' ) ||\n\t\t\t\t\t\tcontainer.hasClass( 'label' )\n\t\t\t\t\t\t\t? 'top'\n\t\t\t\t\t\t\t: 'right';\n\t\t\t\t}\n\n\t\t\t\ttooltip = $( '<span>', {\n\t\t\t\t\tclass: 'yith-wcan-tooltip',\n\t\t\t\t\thtml: th.data( 'title' ),\n\t\t\t\t} );\n\n\t\t\t\tth.append( tooltip );\n\n\t\t\t\twidth = tooltip.outerWidth() + 6;\n\t\t\t\ttooltip.outerWidth( width );\n\n\t\t\t\tif ( 'top' === position ) {\n\t\t\t\t\tleft = ( wrapperWidth - width ) / 2;\n\t\t\t\t} else {\n\t\t\t\t\tleft = wrapperWidth + 15;\n\t\t\t\t}\n\n\t\t\t\ttooltip.css( { left: left.toFixed( 0 ) + 'px' } ).fadeIn( 200 );\n\n\t\t\t\tth.addClass( 'with-tooltip' );\n\t\t\t} ).on( 'mouseleave', function () {\n\t\t\t\tconst th = $( this );\n\n\t\t\t\tth.find( '.yith-wcan-tooltip' ).fadeOut( 200, function () {\n\t\t\t\t\tth.removeClass( 'with-tooltip' )\n\t\t\t\t\t\t.find( '.yith-wcan-tooltip' )\n\t\t\t\t\t\t.remove();\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\tt.addClass( 'tooltip-added' );\n\t\t} );\n\t}\n\n\t// init dropdown\n\t_initDropdown( $filter ) {\n\t\tconst $dropdown = $filter.find( 'select.filter-dropdown' );\n\n\t\tif ( ! $dropdown.length || $dropdown.hasClass( 'enhanced' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t$dropdown.hasClass( 'select2-hidden-accessible' ) &&\n\t\t\t'undefined' !== typeof $.fn.selectWoo\n\t\t) {\n\t\t\t$dropdown.selectWoo( 'destroy' );\n\t\t}\n\n\t\tconst self = this,\n\t\t\thasMore = $dropdown.data( 'has-more' );\n\n\t\tthis._initDropdownObject( $dropdown, {\n\t\t\tpaginate: true,\n\t\t\thasMore,\n\t\t\tperPage: parseInt( yith_wcan_shortcodes.terms_per_page ),\n\t\t\t...( hasMore\n\t\t\t\t? {\n\t\t\t\t\t\tasync getElements( search ) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t( this.paginate || ! this.hasMore ) &&\n\t\t\t\t\t\t\t\t! search\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn this._items;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn self._getTerms( $filter, search );\n\t\t\t\t\t\t},\n\t\t\t\t  }\n\t\t\t\t: {} ),\n\t\t} );\n\t}\n\n\t// init dropdown object\n\t_initDropdownObject( $dropdown, opts ) {\n\t\treturn new YITH_WCAN_Dropdown( $dropdown, opts );\n\t}\n\n\t// init price slider\n\t_initPriceSlider( $filter ) {\n\t\tif ( ! $filter.hasClass( 'filter-price-slider' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst self = this,\n\t\t\t$container = $filter.find( '.price-slider' ),\n\t\t\t$minInput = $container.find( '.price-slider-min' ),\n\t\t\t$maxInput = $container.find( '.price-slider-max' ),\n\t\t\tmin = parseFloat( $container.data( 'min' ) ),\n\t\t\tmax = parseFloat( $container.data( 'max' ) ),\n\t\t\tcurrentMin = parseFloat( $minInput.val() ),\n\t\t\tcurrentMax = parseFloat( $maxInput.val() ),\n\t\t\tstep = parseFloat( $container.data( 'step' ) ),\n\t\t\thandleSliderChange = function () {\n\t\t\t\tif ( self.sliderTimeout ) {\n\t\t\t\t\tclearTimeout( self.sliderTimeout );\n\t\t\t\t}\n\n\t\t\t\tself.sliderTimeout = setTimeout( () => {\n\t\t\t\t\tself.maybeFilter( $filter );\n\t\t\t\t}, 300 );\n\t\t\t};\n\n\t\t$filter\n\t\t\t.find( '.price-slider-ui' )\n\t\t\t.off( 'change' )\n\t\t\t.ionRangeSlider( {\n\t\t\t\tskin: 'round',\n\t\t\t\ttype: 'double',\n\t\t\t\tmin,\n\t\t\t\tmax,\n\t\t\t\tstep,\n\t\t\t\tfrom: currentMin,\n\t\t\t\tto: currentMax,\n\t\t\t\tmin_interval: step,\n\t\t\t\tvalues_separator: ' - ',\n\t\t\t\tprettify: ( v ) => this.formatPrice( v ),\n\t\t\t\tonChange: ( data ) => {\n\t\t\t\t\t$minInput.val( data.from );\n\t\t\t\t\t$maxInput.val( data.to );\n\t\t\t\t},\n\t\t\t\tonFinish: handleSliderChange,\n\t\t\t} );\n\n\t\t$minInput\n\t\t\t.add( $maxInput )\n\t\t\t.off( 'change' )\n\t\t\t.on( 'change', handleSliderChange )\n\t\t\t.on( 'keyup', ( ev ) => {\n\t\t\t\tif ( ! ev.key.match( /[0-9,.]/ ) ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( ! $minInput.val() || ! $maxInput.val() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleSliderChange();\n\t\t\t} );\n\t}\n\n\t// init collapsable\n\t_initCollapsable( $filter ) {\n\t\tthis._initTitleCollapsable( $filter );\n\t\tthis._initHierarchyCollapsable( $filter );\n\t}\n\n\t// init show more filters on click.\n\t_initShowMore( $filter ) {\n\t\tconst $showMore = $filter\n\t\t\t.find( '.filter-content' )\n\t\t\t.children( '.show-more' );\n\n\t\tif ( ! $showMore.length || $showMore.hasClass( 'initialized' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$showMore\n\t\t\t.addClass( 'initialized' )\n\t\t\t.on( 'click', () =>\n\t\t\t\tthis._loadItems( $filter ).then( () => $showMore.remove() )\n\t\t\t);\n\t}\n\n\t_getTerms( $filter, search ) {\n\t\treturn new Promise( ( resolve ) => {\n\t\t\t$.ajax( {\n\t\t\t\tmethod: 'GET',\n\t\t\t\tbeforeSend: () => block( $filter ),\n\t\t\t\tcomplete: () => unblock( $filter ),\n\t\t\t\turl: yith_wcan_shortcodes.base_url,\n\t\t\t\tdata: {\n\t\t\t\t\t'wc-ajax': 'yith_wcan_get_filter_terms',\n\t\t\t\t\t_preset_id: this.getId(),\n\t\t\t\t\t_filter_id: $filter.data( 'filter-id' ),\n\t\t\t\t\tsecurity: yith_wcan_shortcodes.nonces.get_filter_terms,\n\t\t\t\t\tsearch,\n\t\t\t\t\t...this.originalFilters,\n\t\t\t\t},\n\t\t\t} ).then( ( data ) => {\n\t\t\t\tconst $items = data.success ? data?.data?.items : {};\n\t\t\t\tresolve( $items );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// load new page of terms via AJAX\n\t_loadItems( $filter ) {\n\t\treturn new Promise( ( resolve ) => {\n\t\t\t$.ajax( {\n\t\t\t\tmethod: 'GET',\n\t\t\t\tbeforeSend: () => block( $filter ),\n\t\t\t\tcomplete: () => unblock( $filter ),\n\t\t\t\turl: yith_wcan_shortcodes.base_url,\n\t\t\t\tdata: {\n\t\t\t\t\t'wc-ajax': 'yith_wcan_render_remaining_terms',\n\t\t\t\t\t_preset_id: this.getId(),\n\t\t\t\t\t_filter_id: $filter.data( 'filter-id' ),\n\t\t\t\t\tsecurity:\n\t\t\t\t\t\tyith_wcan_shortcodes.nonces.render_remaining_terms,\n\t\t\t\t\t...this.originalFilters,\n\t\t\t\t},\n\t\t\t} ).then( ( data ) => {\n\t\t\t\tconst $items = $filter\n\t\t\t\t\t.find( '.filter-content' )\n\t\t\t\t\t.children( '.filter-items' );\n\n\t\t\t\t// append new items to filter existing ones.\n\t\t\t\t$items.append( data.success ? data?.data?.html : '' );\n\n\t\t\t\t// perform additional initalization of the new items in the filter.\n\t\t\t\tthis._initFilterChildren( $filter );\n\n\t\t\t\t// resolve promise returning jQuery set of the new elements.\n\t\t\t\tresolve( $items );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// init toggle on click of the title\n\t_initTitleCollapsable( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length || $title.hasClass( 'toggle-initialized' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._initToggle( $title, $title, $filter.find( '.filter-content' ) );\n\t}\n\n\t// init toggle on click of the parent li\n\t_initHierarchyCollapsable( $filter ) {\n\t\tconst $items = $filter.find( '.hierarchy-collapsable' );\n\n\t\tif ( ! $items.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// set parents of currently active term as open\n\t\tconst self = this,\n\t\t\tactive = $filter.find( '.active' );\n\n\t\tif ( active.length ) {\n\t\t\tactive\n\t\t\t\t.parents( '.hierarchy-collapsable' )\n\t\t\t\t.removeClass( 'closed' )\n\t\t\t\t.addClass( 'opened' );\n\n\t\t\tif (\n\t\t\t\tactive.hasClass( 'hierarchy-collapsable' ) &&\n\t\t\t\tyith_wcan_shortcodes.show_current_children\n\t\t\t) {\n\t\t\t\tactive.removeClass( 'closed' ).addClass( 'opened' );\n\t\t\t}\n\t\t}\n\n\t\t$items.each( function () {\n\t\t\tconst $t = $( this );\n\n\t\t\tif ( $t.hasClass( 'toggle-initialized' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $toggle = $( '<span/>', {\n\t\t\t\tclass: 'toggle-handle',\n\t\t\t} );\n\n\t\t\t$toggle.appendTo( $t );\n\n\t\t\tself._initToggle( $toggle, $t, $t.children( 'ul.filter-items' ) );\n\t\t} );\n\t}\n\n\t// init toggle to generic toggle/target pair\n\t_initToggle( $toggle, $container, $target ) {\n\t\tif ( $container.hasClass( 'toggle-initialized' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( $container.hasClass( 'closed' ) ) {\n\t\t\t$target.hide();\n\t\t}\n\n\t\t$toggle.off( 'click' ).on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t\tev.preventDefault();\n\n\t\t\tthis.toggle( $target, $container );\n\n\t\t\t$target.trigger( 'yith_wcan_after_toggle_element', [ $container ] );\n\t\t} );\n\n\t\t$container.addClass( 'toggle-initialized' );\n\t}\n\n\t// init custom input\n\t_initCustomInput( $filter ) {\n\t\t$filter.find( ':input' ).each( function () {\n\t\t\tlet input = $( this ),\n\t\t\t\ttype = input.attr( 'type' ),\n\t\t\t\tcontainerClass = `${ type }button`,\n\t\t\t\tcontainer;\n\n\t\t\tif ( 'checkbox' !== type && 'radio' !== type ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( input.closest( `.${ containerClass }` ).length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( input.is( ':checked' ) ) {\n\t\t\t\tcontainerClass += ' checked';\n\t\t\t}\n\n\t\t\tcontainer = $( '<span/>', {\n\t\t\t\tclass: containerClass,\n\t\t\t} );\n\n\t\t\tinput.wrap( container ).on( 'change', function () {\n\t\t\t\tconst t = $( this );\n\n\t\t\t\tt.prop( 'checked' )\n\t\t\t\t\t? t.parent().addClass( 'checked' )\n\t\t\t\t\t: t.parent().removeClass( 'checked' );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// register initial status\n\t_regiterStatus() {\n\t\tthis.originalFilters = this.mergeProperties(\n\t\t\tyith_wcan_shortcodes.query_vars,\n\t\t\tthis.getFiltersProperties()\n\t\t);\n\t}\n\n\t// trigger handling after layout change\n\t_afterLayoutChange() {\n\t\tif ( this.isMobile ) {\n\t\t\tthis.$preset\n\t\t\t\t.addClass( 'filters-modal' )\n\t\t\t\t.attr( 'role', 'dialog' )\n\t\t\t\t.attr( 'tabindex', '-1' )\n\t\t\t\t.hide();\n\n\t\t\tthis._addCloseModalButton();\n\t\t\tthis._addApplyFiltersModalButton();\n\t\t\tthis.loaded.then( () => this._switchToCollapsables() );\n\n\t\t\tthis.$filterButtons?.hide();\n\t\t} else {\n\t\t\tthis.$preset\n\t\t\t\t.removeClass( 'filters-modal' )\n\t\t\t\t.removeClass( 'open' )\n\t\t\t\t.removeAttr( 'role' )\n\t\t\t\t.removeAttr( 'tabindex' )\n\t\t\t\t.show();\n\n\t\t\t$( 'body' )\n\t\t\t\t.css( 'overflow', 'auto' )\n\t\t\t\t.removeClass( 'yith-wcan-preset-modal-open' );\n\n\t\t\tthis._removeCloseModalButton();\n\t\t\tthis._removeApplyFiltersModalButton();\n\t\t\tthis.loaded.then( () => this._switchBackCollapsables() );\n\n\t\t\tthis.$filterButtons?.show();\n\t\t}\n\t}\n\n\t// add modal close button\n\t_addCloseModalButton() {\n\t\tconst $closeButton = $( '<a/>', {\n\t\t\tclass: 'close-button',\n\t\t\thtml: '&times;',\n\t\t\t'data-dismiss': 'modal',\n\t\t\t'aria-label': yith_wcan_shortcodes.labels.close,\n\t\t} );\n\n\t\t$closeButton\n\t\t\t.prependTo( this.$preset )\n\t\t\t.on( 'click', this.closeModal.bind( this ) );\n\t\tthis.modalElements.closeButton = $closeButton;\n\t}\n\n\t// remove modal close button\n\t_removeCloseModalButton() {\n\t\tthis.modalElements?.closeButton?.remove();\n\t}\n\n\t// show main filter button for the modal\n\t_addApplyFiltersModalButton() {\n\t\tconst $filterButton = $( '<button/>', {\n\t\t\tclass: 'apply-filters main-modal-button',\n\t\t\thtml: yith_wcan_shortcodes.labels.show_results,\n\t\t\t'data-dismiss': 'modal',\n\t\t} );\n\n\t\t$filterButton.appendTo( this.$preset ).on( 'click', () => {\n\t\t\tthis.filter();\n\t\t\tthis.closeModal();\n\t\t} );\n\t\tthis.modalElements.applyFiltersButton = $filterButton;\n\t}\n\n\t// hide main filter button for the modal\n\t_removeApplyFiltersModalButton() {\n\t\tthis.modalElements?.applyFiltersButton?.remove();\n\t}\n\n\t// convert all filters to collapsable\n\t_switchToCollapsables() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$title = $filter.find( '.filter-title' );\n\n\t\t\tif ( ! $title.length || $title.hasClass( 'collapsable' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$title.addClass( 'collapsable' ).data( 'disable-collapse', true );\n\n\t\t\tself._initTitleCollapsable( $filter );\n\t\t} );\n\t}\n\n\t// switch back filters to their previous collapsable state\n\t_switchBackCollapsables() {\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$title = $filter.find( '.filter-title' );\n\n\t\t\tif (\n\t\t\t\t! $title.length ||\n\t\t\t\t! $title.hasClass( 'collapsable' ) ||\n\t\t\t\t! $title.data( 'disable-collapse' )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$title\n\t\t\t\t.removeClass( 'collapsable' )\n\t\t\t\t.removeData( 'disable-collapse', true )\n\t\t\t\t.off( 'click' );\n\n\t\t\t$filter.find( '.filter-content' ).show();\n\t\t} );\n\t}\n\n\t// close all collpasable before showing modal\n\t_openAllCollapsables() {\n\t\tthis.getFilters()\n\t\t\t.not( '.no-title' )\n\t\t\t.not( ( i, v ) => {\n\t\t\t\treturn this.isFilterActive( $( v ) );\n\t\t\t} )\n\t\t\t.find( '.filter-content' )\n\t\t\t.show()\n\t\t\t.end()\n\t\t\t.find( '.filter-title' )\n\t\t\t.removeClass( 'closed' )\n\t\t\t.addClass( 'opened' );\n\t}\n\n\t// close all collpasable before showing modal\n\t_closeAllCollapsables() {\n\t\tthis.getFilters()\n\t\t\t.not( '.no-title' )\n\t\t\t.not( ( i, v ) => {\n\t\t\t\treturn this.isFilterActive( $( v ) );\n\t\t\t} )\n\t\t\t.find( '.filter-content' )\n\t\t\t.hide()\n\t\t\t.end()\n\t\t\t.find( '.filter-title' )\n\t\t\t.addClass( 'closed' )\n\t\t\t.removeClass( 'opened' );\n\t}\n\n\t// update status change flag, if filters have changed\n\tmaybeRegisterStatusChange() {\n\t\tconst currentFilters = this.getFiltersProperties(),\n\t\t\tcurrentStr = JSON.stringify( currentFilters ),\n\t\t\toriginalStr = JSON.stringify( this.originalFilters );\n\n\t\tthis.dirty = currentStr !== originalStr;\n\t}\n\n\t// apply filters when possible\n\tmaybeFilter( $initiator ) {\n\t\t// register status change\n\t\tthis.maybeRegisterStatusChange();\n\n\t\t// skip if filters are inhibited.\n\t\tif ( this.inhibitFilters ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// filter, or show filter button.\n\t\tif ( yith_wcan_shortcodes.instant_filters && ! this.isMobile ) {\n\t\t\tthis.filter();\n\t\t} else if (\n\t\t\t! yith_wcan_shortcodes.instant_filters &&\n\t\t\t! this.isMobile\n\t\t) {\n\t\t\tthis.dirty\n\t\t\t\t? this.$filterButtons?.show()\n\t\t\t\t: this.$filterButtons?.hide();\n\t\t} else if ( this.isMobile && this.dirty ) {\n\t\t\tthis.$preset.addClass( 'with-filter-button' );\n\t\t\tthis.modalElements.applyFiltersButton?.show();\n\t\t}\n\t}\n\n\t// main filtering method\n\tfilter() {\n\t\tconst filter = window?.product_filter;\n\n\t\tfilter\n\t\t\t?.doFilter( this.getFiltersProperties(), this.target, this.preset )\n\t\t\t?.done( () => {\n\t\t\t\tlet newPreset = $( this.preset );\n\n\t\t\t\tif ( newPreset.length && yith_wcan_shortcodes.scroll_top ) {\n\t\t\t\t\t// by default, scroll till top of first preset in the page.\n\t\t\t\t\tlet targetOffset = newPreset.offset().top;\n\n\t\t\t\t\tif ( !! yith_wcan_shortcodes.scroll_target ) {\n\t\t\t\t\t\t// when we have a specific target, use that for the offset.\n\t\t\t\t\t\tconst $scrollTarget = $(\n\t\t\t\t\t\t\tyith_wcan_shortcodes.scroll_target\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\ttargetOffset = $scrollTarget.length\n\t\t\t\t\t\t\t? $scrollTarget.offset().top\n\t\t\t\t\t\t\t: targetOffset;\n\t\t\t\t\t} else if ( this.isMobile ) {\n\t\t\t\t\t\t// otherwise, if we're on mobile, scroll to the top of the page\n\t\t\t\t\t\t// (preset could be in an unexpected location).\n\t\t\t\t\t\ttargetOffset = 100;\n\t\t\t\t\t}\n\n\t\t\t\t\t$( 'body, html' ).animate( {\n\t\t\t\t\t\tscrollTop: targetOffset - 100,\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// register new filters, clear status flag\n\t\t\t\tthis._regiterStatus();\n\t\t\t\tthis.dirty = false;\n\t\t\t} );\n\n\t\tif ( this.isMobile ) {\n\t\t\tthis.$preset.removeClass( 'with-filter-button' );\n\t\t\tthis.modalElements.applyFiltersButton?.hide();\n\t\t\tthis.closeModal();\n\t\t}\n\t}\n\n\t// returns preset id\n\tgetId() {\n\t\treturn this.$preset.data( 'preset-id' );\n\t}\n\n\t// get all filter nodes\n\tgetFilters() {\n\t\tif ( false === this.$filters ) {\n\t\t\tthis.$filters = this.$preset.find( '.yith-wcan-filter' );\n\t\t}\n\n\t\treturn this.$filters;\n\t}\n\n\t// retrieves all filters that we want to apply\n\tgetActiveFilters() {\n\t\tif ( false === this.activeFilters ) {\n\t\t\tthis.activeFilters = this.getFiltersProperties();\n\t\t}\n\n\t\treturn this.activeFilters;\n\t}\n\n\t// check whether there is any filter active\n\tisAnyFilterActive() {\n\t\treturn !! Object.keys( this.getActiveFilters() ).length;\n\t}\n\n\t// checks whether current filter is active\n\tisFilterActive( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tactive,\n\t\t\tfilteredActive;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\tcase 'review':\n\t\t\tcase 'price_range':\n\t\t\t\tconst $dropdown = $filter.find( '.filter-dropdown' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tconst val = $dropdown.val();\n\n\t\t\t\t\tactive = 'object' === typeof val ? !! val?.length : !! val;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t// if we use type other than dropdown, fallthrough\n\t\t\tcase 'stock_sale':\n\t\t\t\tactive = $filter\n\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t.filter( '.active' ).length;\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tconst step = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'step' )\n\t\t\t\t\t),\n\t\t\t\t\tmin = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'min' )\n\t\t\t\t\t),\n\t\t\t\t\tmax = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'max' )\n\t\t\t\t\t),\n\t\t\t\t\tcurrentMin = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider-min' ).val()\n\t\t\t\t\t),\n\t\t\t\t\tcurrentMax = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider-max' ).val()\n\t\t\t\t\t);\n\n\t\t\t\tactive =\n\t\t\t\t\tMath.abs( currentMin - min ) >= step ||\n\t\t\t\t\tMath.abs( currentMax - max ) >= step;\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tactive =\n\t\t\t\t\t'menu_order' !== $filter.find( '.filter-order-by' ).val();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tactive = false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfilteredActive = $filter.triggerHandler( 'yith_wcan_is_filter_active', [\n\t\t\tactive,\n\t\t\tthis,\n\t\t] );\n\t\tactive =\n\t\t\ttypeof filteredActive !== 'undefined' ? filteredActive : active;\n\n\t\treturn active;\n\t}\n\n\t// count the number of active items per filter\n\tcountActiveItems( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tcount;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\tcase 'review':\n\t\t\tcase 'price_range':\n\t\t\t\tconst $dropdown = $filter.find( '.filter-dropdown' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tconst val = $dropdown.val();\n\n\t\t\t\t\tcount = 'object' === typeof val ? val?.length : +!! val;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t// if we use type other than dropdown, fallthrough\n\t\t\tcase 'stock_sale':\n\t\t\t\tcount = $filter\n\t\t\t\t\t.find( '.filter-items' )\n\t\t\t\t\t.find( '.active' ).length;\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tif ( this.isFilterActive( $filter ) ) {\n\t\t\t\t\tcount = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\tdefault:\n\t\t\t\tcount = 0;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t// retrieves filter properties for the filter\n\tgetFilterProperties( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tmultiple = 'yes' === $filter.data( 'multiple' ),\n\t\t\t$dropdown = $filter.find( '.filter-dropdown' ),\n\t\t\tproperties = {},\n\t\t\tfilteredProperties,\n\t\t\t$active;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\t\tlet activeTerms = [],\n\t\t\t\t\ttaxonomy = $filter.data( 'taxonomy' ),\n\t\t\t\t\tisAttr = 0 === taxonomy.indexOf( 'filter' ),\n\t\t\t\t\trelation = $filter.data( 'relation' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tactiveTerms = $dropdown.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tactiveTerms.push( $dropdown.val() );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tactiveTerms = $active.get().reduce( function ( a, v ) {\n\t\t\t\t\t\tlet val;\n\n\t\t\t\t\t\tv = $( v );\n\t\t\t\t\t\tval = v.is( 'label' )\n\t\t\t\t\t\t\t? v.find( ':input' ).val()\n\t\t\t\t\t\t\t: v.data( 'term-slug' );\n\n\t\t\t\t\t\tif ( ! val ) {\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ta.push( val );\n\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t}, activeTerms );\n\t\t\t\t}\n\n\t\t\t\tif ( ! multiple ) {\n\t\t\t\t\tproperties[ taxonomy ] = activeTerms.pop();\n\t\t\t\t} else {\n\t\t\t\t\tconst glue = ! isAttr && 'and' === relation ? '+' : ',';\n\t\t\t\t\tproperties[ taxonomy ] = activeTerms.join( glue );\n\t\t\t\t}\n\n\t\t\t\tif ( isAttr ) {\n\t\t\t\t\tproperties[ taxonomy.replace( 'filter_', 'query_type_' ) ] =\n\t\t\t\t\t\trelation;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'review':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tproperties.rating_filter = $dropdown.val();\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tif ( ! multiple ) {\n\t\t\t\t\t\t$active = $active.first();\n\t\t\t\t\t\tproperties.rating_filter = $active.is( 'label' )\n\t\t\t\t\t\t\t? $active.find( ':input' ).val()\n\t\t\t\t\t\t\t: $active.data( 'rating' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.rating_filter = $active\n\t\t\t\t\t\t\t.get()\n\t\t\t\t\t\t\t.reduce( function ( a, v ) {\n\t\t\t\t\t\t\t\tlet val;\n\n\t\t\t\t\t\t\t\tv = $( v );\n\t\t\t\t\t\t\t\tval = v.is( 'label' )\n\t\t\t\t\t\t\t\t\t? v.find( ':input' ).val()\n\t\t\t\t\t\t\t\t\t: v.data( 'rating' );\n\n\t\t\t\t\t\t\t\tif ( ! val ) {\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ta.push( val );\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, [] )\n\t\t\t\t\t\t\t.join( ',' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_range':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tproperties.price_ranges = $dropdown.val().join( ',' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.min_price = $dropdown\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t.split( '-' )[ 0 ];\n\t\t\t\t\t\tproperties.max_price = $dropdown\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t.split( '-' )[ 1 ];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tproperties.price_ranges = $active\n\t\t\t\t\t\t\t.get()\n\t\t\t\t\t\t\t.reduce( ( a, v ) => {\n\t\t\t\t\t\t\t\tlet min = $( v ).data( 'range-min' ),\n\t\t\t\t\t\t\t\t\tmax = $( v ).data( 'range-max' );\n\n\t\t\t\t\t\t\t\ta += ( max ? `${ min }-${ max }` : min ) + ',';\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, '' )\n\t\t\t\t\t\t\t.replace( /^(.*),$/, '$1' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.min_price = parseFloat(\n\t\t\t\t\t\t\t$active.first().data( 'range-min' )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tproperties.max_price = parseFloat(\n\t\t\t\t\t\t\t$active.first().data( 'range-max' )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tproperties.min_price = parseFloat(\n\t\t\t\t\t$filter.find( '.price-slider-min' ).val()\n\t\t\t\t);\n\t\t\t\tproperties.max_price = parseFloat(\n\t\t\t\t\t$filter.find( '.price-slider-max' ).val()\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 'stock_sale':\n\t\t\t\tif ( $filter.find( '.filter-on-sale' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.onsale_filter = 1;\n\t\t\t\t}\n\t\t\t\tif ( $filter.find( '.filter-in-stock' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.instock_filter = 1;\n\t\t\t\t}\n\t\t\t\tif ( $filter.find( '.filter-featured' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.featured_filter = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tproperties.orderby = $filter.find( '.filter-order-by' ).val();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfilteredProperties = $filter.triggerHandler(\n\t\t\t'yith_wcan_filter_properties',\n\t\t\t[ properties, self ]\n\t\t);\n\t\tproperties =\n\t\t\ttypeof filteredProperties !== 'undefined'\n\t\t\t\t? filteredProperties\n\t\t\t\t: properties;\n\n\t\treturn properties;\n\t}\n\n\t// retrieves properties for all filters of the preset\n\tgetFiltersProperties() {\n\t\tlet properties = {};\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tif ( self.isFilterActive( $filter ) ) {\n\t\t\t\tconst filterProperties = self.getFilterProperties( $filter );\n\n\t\t\t\tproperties = self.mergeProperties(\n\t\t\t\t\tproperties,\n\t\t\t\t\tfilterProperties,\n\t\t\t\t\t$filter\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t\treturn properties;\n\t}\n\n\t// retrieve filters matching any of the properties passed\n\tgetFiltersByProperties( properties ) {\n\t\tconst self = this;\n\n\t\treturn this.getFilters().filter( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tif ( self.isFilterActive( $filter ) ) {\n\t\t\t\tlet filterProperties = self.getFilterProperties( $filter ),\n\t\t\t\t\thasProp = false;\n\n\t\t\t\tfor ( const prop of properties ) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t[ 'min_price', 'max_price', 'price_ranges' ].includes(\n\t\t\t\t\t\t\tprop\n\t\t\t\t\t\t) &&\n\t\t\t\t\t\t( filterProperties.min_price ||\n\t\t\t\t\t\t\tfilterProperties.price_ranges )\n\t\t\t\t\t) {\n\t\t\t\t\t\thasProp = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if ( filterProperties[ prop ] ) {\n\t\t\t\t\t\thasProp = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn hasProp;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t} );\n\t}\n\n\t// show clear selection anchor\n\tmaybeToggleClearFilter( $filter ) {\n\t\tif ( ! this.isFilterActive( $filter ) ) {\n\t\t\tthis.maybeHideClearFilter( $filter );\n\t\t} else {\n\t\t\tthis.maybeShowClearFilter( $filter );\n\t\t}\n\t}\n\n\t// show clear all selections anchor\n\tmaybeToggleClearAllFilters() {\n\t\tif ( ! this.isAnyFilterActive() ) {\n\t\t\tthis.maybeHideClearAllFilters();\n\t\t} else {\n\t\t\tthis.maybeShowClearAllFilters();\n\t\t}\n\t}\n\n\t// show clear selection anchor\n\tmaybeShowClearFilter( $filter ) {\n\t\tif (\n\t\t\t! this.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link if already added.\n\t\t$filter.find( '.clear-selection' ).remove();\n\n\t\t// add new clear selection link.\n\t\t$( '<a/>', {\n\t\t\tclass: 'clear-selection',\n\t\t\ttext: yith_wcan_shortcodes.labels.clear_selection,\n\t\t\trole: 'button',\n\t\t} )\n\t\t\t.prependTo( $filter.find( '.filter-content' ) )\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tthis.deactivateFilter(\n\t\t\t\t\t$filter,\n\t\t\t\t\tfalse,\n\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t);\n\t\t\t\tthis.maybeHideClearFilter( $filter );\n\n\t\t\t\tif ( yith_wcan_shortcodes.instant_filters ) {\n\t\t\t\t\tthis.closeModal();\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\t// show clearAll anchor, when on mobile layout\n\tmaybeShowClearAllFilters() {\n\t\tif ( ! this.isAnyFilterActive() || ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link if already added.\n\t\tthis.$preset.find( '.clear-selection' ).remove();\n\n\t\t// add new clear selection link.\n\t\t$( '<a/>', {\n\t\t\tclass: 'clear-selection',\n\t\t\ttext: yith_wcan_shortcodes.labels.clear_all_selections,\n\t\t\trole: 'button',\n\t\t} )\n\t\t\t.prependTo( this.$preset.find( '.filters-container' ) )\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tthis.deactivateAllFilters(\n\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t);\n\t\t\t\tthis.maybeHideClearAllFilters();\n\n\t\t\t\tif ( yith_wcan_shortcodes.instant_filters ) {\n\t\t\t\t\tthis.closeModal();\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\t// hide clear selection anchor\n\tmaybeHideClearFilter( $filter ) {\n\t\tif (\n\t\t\tthis.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link.\n\t\t$filter.find( '.clear-selection' ).remove();\n\t}\n\n\t// show clearAll anchor, when on mobile layout\n\tmaybeHideClearAllFilters() {\n\t\tif ( this.isAnyFilterActive() ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link.\n\t\tthis.$preset\n\t\t\t.find( '.filters-container' )\n\t\t\t.children( '.clear-selection' )\n\t\t\t.remove();\n\t}\n\n\t// deactivate filter\n\tdeactivateFilter( $filter, properties, doFilter ) {\n\t\tconst filterType = $filter.data( 'filter-type' ),\n\t\t\t$items = $filter.find( '.filter-item' ),\n\t\t\t$activeItems = $items.filter( '.active' ),\n\t\t\t$dropdown = $filter.find( '.filter-dropdown' );\n\n\t\tthis.inhibitFilters = true;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\t\tconst taxonomy = $filter.data( 'taxonomy' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this );\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t$option.val().toString() ===\n\t\t\t\t\t\t\t\tproperties[ taxonomy ].toString()\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'term-slug' );\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tvalue.toString() ===\n\t\t\t\t\t\t\tproperties[ taxonomy ].toString()\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'review':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this );\n\n\t\t\t\t\t\t\tif ( $option.val() === properties.rating_filter ) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'rating' );\n\n\t\t\t\t\t\tif ( value === properties.rating_filter ) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_range':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this ),\n\t\t\t\t\t\t\t\tformattedRange =\n\t\t\t\t\t\t\t\t\tproperties.min_price +\n\t\t\t\t\t\t\t\t\t( properties.max_price\n\t\t\t\t\t\t\t\t\t\t? `-${ properties.max_price }`\n\t\t\t\t\t\t\t\t\t\t: '' );\n\n\t\t\t\t\t\t\tif ( $option.val() === formattedRange ) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tformattedRange,\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'min_price' ) +\n\t\t\t\t\t\t\t  ( $anchor.data( 'max_price' )\n\t\t\t\t\t\t\t\t\t? '-' + $anchor.data( 'max_price' )\n\t\t\t\t\t\t\t\t\t: '' );\n\n\t\t\t\t\t\tif ( properties.min_price ) {\n\t\t\t\t\t\t\tformattedRange =\n\t\t\t\t\t\t\t\tproperties.min_price +\n\t\t\t\t\t\t\t\t( properties.max_price\n\t\t\t\t\t\t\t\t\t? '-' + properties.max_price\n\t\t\t\t\t\t\t\t\t: '' );\n\t\t\t\t\t\t} else if ( properties.price_ranges ) {\n\t\t\t\t\t\t\tformattedRange = properties.price_ranges;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( value === formattedRange ) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tconst $priceSlider = $filter.find( '.price-slider' );\n\n\t\t\t\t$filter\n\t\t\t\t\t.find( '.price-slider-min' )\n\t\t\t\t\t.val( $priceSlider.data( 'min' ) );\n\t\t\t\t$filter\n\t\t\t\t\t.find( '.price-slider-max' )\n\t\t\t\t\t.val( $priceSlider.data( 'max' ) )\n\t\t\t\t\t.change();\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\t$filter.find( 'select' ).val( 'menu_order' );\n\t\t\t\tbreak;\n\t\t\tcase 'stock_sale':\n\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-in-stock' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-on-sale' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-featured' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\n\t\t\t\t\t$items.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\tif ( properties?.instock_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-in-stock' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( properties?.onsale_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-on-sale' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( properties?.featured_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-featured' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t$items.removeClass( 'active' );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.inhibitFilters = false;\n\t\tthis.activeFilters = false;\n\n\t\tif ( doFilter ) {\n\t\t\tthis.filter();\n\t\t}\n\t}\n\n\t// deactivate all filters\n\tdeactivateAllFilters( doFilter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself.deactivateFilter( $filter );\n\t\t} );\n\n\t\tthis.activeFilters = false;\n\n\t\tif ( doFilter ) {\n\t\t\tthis.filter();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// deactivate filters that matches a specific set of properties\n\tdeactivateFilterByProperties( properties, doFilter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFiltersByProperties( Object.keys( properties ) );\n\n\t\tif ( ! $filters.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t$filters.each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself.deactivateFilter( $filter, properties, doFilter );\n\t\t} );\n\n\t\treturn true;\n\t}\n\n\t// open toggle\n\ttoggle( $target, $container, status ) {\n\t\tif ( 'undefined' === typeof status ) {\n\t\t\tstatus = $container.hasClass( 'closed' );\n\t\t}\n\n\t\tconst method = status ? 'slideDown' : 'slideUp',\n\t\t\tclassToAdd = status ? 'opened' : 'closed',\n\t\t\tclassToRemove = status ? 'closed' : 'opened';\n\n\t\t$target[ method ]( 400, () => {\n\t\t\t$container.addClass( classToAdd ).removeClass( classToRemove );\n\n\t\t\t$target.trigger( 'yith_wcan_toggle_element', [\n\t\t\t\t$container,\n\t\t\t\tstatus,\n\t\t\t] );\n\t\t} );\n\t}\n\n\t// open filter if title is collapsable\n\topenFilter( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggle( $filter.find( '.filter-content' ), $title, true );\n\t}\n\n\t// open all filters in a preset\n\topenAllFilters( $filter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tself.openFilter( $( this ) );\n\t\t} );\n\t}\n\n\t// close filter if title is collapsable\n\tcloseFilter( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggle( $filter.find( '.filter-content' ), $title, false );\n\t}\n\n\t// close all filters in a preset; if a specific filter is pased as parameter, system will keep it open\n\tcloseAllFilters( $filter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tself.closeFilter( $( this ) );\n\t\t} );\n\n\t\tif ( 'undefined' !== typeof $filter ) {\n\t\t\tthis.openFilter( $filter );\n\t\t}\n\t}\n\n\t// open filters as a modal, when in mobile layout\n\topenModal() {\n\t\tif ( ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( yith_wcan_shortcodes.toggles_open_on_modal ) {\n\t\t\tthis._openAllCollapsables();\n\t\t} else {\n\t\t\tthis._closeAllCollapsables();\n\t\t}\n\n\t\t$( 'body' )\n\t\t\t.css( 'overflow', 'hidden' )\n\t\t\t.addClass( 'yith-wcan-preset-modal-open' );\n\n\t\tthis.$preset.show();\n\n\t\tsetTimeout( () => {\n\t\t\tthis.$preset.addClass( 'open' );\n\t\t}, 100 );\n\t}\n\n\t// close filters modal, when in mobile layout\n\tcloseModal() {\n\t\tif ( ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$preset.removeClass( 'open' );\n\n\t\tsetTimeout( () => {\n\t\t\tthis.$preset.hide();\n\t\t\t$( 'body' )\n\t\t\t\t.css( 'overflow', 'auto' )\n\t\t\t\t.removeClass( 'yith-wcan-preset-modal-open' );\n\t\t}, 300 );\n\t}\n\n\t// utility that formats the price according to store configuration.\n\tformatPrice( price ) {\n\t\tif ( 'undefined' !== typeof accounting ) {\n\t\t\tprice = accounting.formatMoney( price, {\n\t\t\t\tsymbol: yith_wcan_shortcodes.currency_format?.symbol,\n\t\t\t\tdecimal: yith_wcan_shortcodes.currency_format?.decimal,\n\t\t\t\tthousand: yith_wcan_shortcodes.currency_format?.thousand,\n\t\t\t\tprecision: 0,\n\t\t\t\tformat: yith_wcan_shortcodes.currency_format?.format,\n\t\t\t} );\n\t\t}\n\n\t\treturn price;\n\t}\n\n\t// utility that merges together sets of filter properties\n\tmergeProperties( set1, set2, $filter ) {\n\t\t// search for common properties\n\t\tfor ( const prop in set2 ) {\n\t\t\tif ( ! set2.hasOwnProperty( prop ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( !! set1[ prop ] ) {\n\t\t\t\tswitch ( prop ) {\n\t\t\t\t\tcase 'rating_filter':\n\t\t\t\t\tcase 'min_price':\n\t\t\t\t\tcase 'max_price':\n\t\t\t\t\tcase 'onsale_filter':\n\t\t\t\t\tcase 'instock_filter':\n\t\t\t\t\tcase 'orderby':\n\t\t\t\t\t\t// just override default value\n\t\t\t\t\t\tset1[ prop ] = set2[ prop ];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif ( 0 === prop.indexOf( 'query_type_' ) ) {\n\t\t\t\t\t\t\t// query_type param\n\t\t\t\t\t\t\tset1[ prop ] = set2[ prop ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// we're dealing with taxonomy\n\t\t\t\t\t\t\tconst relation =\n\t\t\t\t\t\t\t\t\t$filter?.data( 'relation' ) || 'and',\n\t\t\t\t\t\t\t\tisAttr = 0 === prop.indexOf( 'filter_' ),\n\t\t\t\t\t\t\t\tglue =\n\t\t\t\t\t\t\t\t\t! isAttr && 'and' === relation ? '+' : ',';\n\n\t\t\t\t\t\t\tlet newValue =\n\t\t\t\t\t\t\t\tset1[ prop ].replace( ',', glue ) +\n\t\t\t\t\t\t\t\tglue +\n\t\t\t\t\t\t\t\tset2[ prop ].replace( ',', glue );\n\n\t\t\t\t\t\t\tnewValue = newValue\n\t\t\t\t\t\t\t\t.split( glue )\n\t\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t\t( value, index, arr ) =>\n\t\t\t\t\t\t\t\t\t\tarr.indexOf( value ) === index\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.join( glue );\n\n\t\t\t\t\t\t\tset1[ prop ] = newValue;\n\n\t\t\t\t\t\t\tif ( isAttr ) {\n\t\t\t\t\t\t\t\tconst queryTypeParam = prop.replace(\n\t\t\t\t\t\t\t\t\t'filter_',\n\t\t\t\t\t\t\t\t\t'query_type_'\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tset1[ queryTypeParam ] = 'and';\n\t\t\t\t\t\t\t\tset2[ queryTypeParam ] = 'and';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdelete set2[ prop ];\n\t\t\t}\n\t\t}\n\n\t\t$.extend( set1, set2 );\n\n\t\treturn set1;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../globals.js';\nimport YITH_WCAN_Dropdown from './yith-wcan-dropdown';\n\nexport default class YITH_WCAN_Dropdown_Premium extends YITH_WCAN_Dropdown {\n\t// preset DOM\n\t$preset = false;\n\n\t// retrieve preset containing, if any\n\tgetPreset() {\n\t\tif ( this.preset ) {\n\t\t\treturn this.preset;\n\t\t}\n\n\t\tthis.$preset = this.$originalSelect.closest( '.yith-wcan-filters' );\n\n\t\tif ( ! this.$preset.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.$preset;\n\t}\n\n\t// create dropdown\n\t_initTemplate() {\n\t\tif ( ! this.getPreset()?.hasClass( 'horizontal' ) ) {\n\t\t\tsuper._initTemplate();\n\t\t} else {\n\t\t\tconst $dropdownSpan = $( '<div>', {\n\t\t\t\t\tclass: 'dropdown-wrapper',\n\t\t\t\t} ),\n\t\t\t\t$matchingItemsList = $( '<ul/>', {\n\t\t\t\t\tclass: 'matching-items filter-items',\n\t\t\t\t} );\n\n\t\t\t$dropdownSpan.append( $matchingItemsList );\n\n\t\t\tif ( this.options.showSearch ) {\n\t\t\t\tthis._initSearchTemplate( $dropdownSpan );\n\t\t\t}\n\n\t\t\tif ( this.options.paginate ) {\n\t\t\t\tthis._initShowMoreTemplate( $dropdownSpan );\n\t\t\t}\n\n\t\t\tthis.$originalSelect.after( $dropdownSpan );\n\t\t\tthis.$_main = null;\n\t\t\tthis.$_label = null;\n\t\t\tthis.$_dropdown = $dropdownSpan;\n\t\t\tthis.$_items = $matchingItemsList;\n\n\t\t\tthis._populateItems();\n\t\t}\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../globals.js';\nimport YITH_WCAN_Preset from './yith-wcan-preset';\nimport YITH_WCAN_Dropdown_Premium from './yith-wcan-dropdown-premium';\n\nexport default class YITH_WCAN_Preset_Premium extends YITH_WCAN_Preset {\n\t// init object\n\tconstructor( el ) {\n\t\tsuper( el );\n\n\t\tif ( this.isHorizontal() && ! globalThis.yith_wcan_backdrop_init ) {\n\t\t\tthis._initBackdropClick();\n\t\t\tglobalThis.yith_wcan_backdrop_init = true;\n\t\t}\n\t}\n\n\t// handles click outside of toggles, to close them in horizontal mode\n\t_initBackdropClick() {\n\t\tconst isHorizontal = this.isHorizontal();\n\n\t\tif ( isHorizontal ) {\n\t\t\tthis.getFilters().on( 'click', ( ev ) => ev.stopPropagation() );\n\n\t\t\t$( document ).on( 'click', () => {\n\t\t\t\tif ( this.isMobile ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.maybeCloseAllHorizontalToggles();\n\t\t\t} );\n\t\t}\n\t}\n\n\t// check if preset has horizontal layout\n\tisHorizontal() {\n\t\treturn this.$preset?.hasClass( 'horizontal' );\n\t}\n\n\t// apply filters when possible\n\tmaybeFilter( $initiator ) {\n\t\tconst $filter = $initiator.closest( '.yith-wcan-filter' );\n\n\t\t// register status change\n\t\tthis.maybeRegisterStatusChange();\n\n\t\tif (\n\t\t\tthis.isHorizontal() &&\n\t\t\t! this.isMobile &&\n\t\t\tthis.isHorizontalToggle( $filter.find( '.filter-title' ) )\n\t\t) {\n\t\t\t// show count when necessary\n\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\n\t\t\t// skip filtering when started from anything but Save and Clear buttons, in horizontal mode.\n\t\t\tif (\n\t\t\t\t! $initiator.hasClass( 'apply-filters' ) &&\n\t\t\t\t! $initiator.hasClass( 'clear-selection' ) &&\n\t\t\t\t! yith_wcan_shortcodes.instant_horizontal_filter\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tyith_wcan_shortcodes.instant_filters &&\n\t\t\tyith_wcan_shortcodes.instant_horizontal_filter\n\t\t) {\n\t\t\tthis.maybeCloseAllHorizontalToggles();\n\t\t}\n\n\t\tsuper.maybeFilter();\n\t}\n\n\t// show clear selection anchor\n\tmaybeShowClearFilter( $filter ) {\n\t\tif (\n\t\t\t! this.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! this.isHorizontal() || this.isMobile ) {\n\t\t\tsuper.maybeShowClearFilter( $filter );\n\t\t} else {\n\t\t\t// remove clear selection link if already added.\n\t\t\t$filter.find( '.clear-selection' ).remove();\n\n\t\t\t// add new clear selection link.\n\t\t\tconst $clearButton = $( '<a/>', {\n\t\t\t\tclass: 'clear-selection button',\n\t\t\t\ttext: yith_wcan_shortcodes.labels.clear_selection,\n\t\t\t\trole: 'button',\n\t\t\t} );\n\n\t\t\t$clearButton\n\t\t\t\t.prependTo( $filter.find( '.filter-content-footer' ) )\n\t\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\t\tev.preventDefault();\n\n\t\t\t\t\tthis.deactivateFilter(\n\t\t\t\t\t\t$filter,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t\t);\n\t\t\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\t\t\t\t\tthis.maybeHideClearFilter( $filter );\n\t\t\t\t\tthis.maybeFilter( $clearButton );\n\n\t\t\t\t\tthis.maybeCloseHorizontalToggle(\n\t\t\t\t\t\t$filter.find( '.filter-title.collapsable' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t}\n\n\t// init filter\n\t_initFilter( $filter ) {\n\t\treturn super._initFilter( $filter ).then( () => {\n\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\t\t\tthis.isHorizontal() &&\n\t\t\t\t! yith_wcan_shortcodes.instant_horizontal_filter &&\n\t\t\t\t$filter.on( 'click', ( ev ) => ev.stopPropagation() );\n\t\t} );\n\t}\n\n\t// init tooltip\n\t_initTooltip( $filter, position ) {\n\t\tif ( this.isHorizontal() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper._initTooltip( $filter, position );\n\t}\n\n\t// trigger handling after layout change\n\t_afterLayoutChange() {\n\t\tsuper._afterLayoutChange();\n\n\t\tif ( this.isMobile ) {\n\t\t\tthis._removeAllHorizontalTogglesFooter();\n\t\t} else {\n\t\t\tthis._addAllHorizontalTogglesFooter();\n\t\t}\n\t}\n\n\t// init dropdown object\n\t_initDropdownObject( $dropdown, opts ) {\n\t\treturn new YITH_WCAN_Dropdown_Premium( $dropdown, opts );\n\t}\n\n\t// init toggle to generic toggle/target pair\n\t_initToggle( $toggle, $container, $target ) {\n\t\tconst isHorizontal = this.isHorizontal();\n\n\t\tif ( $container.hasClass( 'closed' ) ) {\n\t\t\t$target.hide();\n\t\t}\n\n\t\tif ( isHorizontal ) {\n\t\t\tthis._addHorizontalToggleFooter( $toggle );\n\t\t}\n\n\t\t$toggle.off( 'click' ).on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\n\t\t\tif (\n\t\t\t\tisHorizontal &&\n\t\t\t\t! this.isMobile &&\n\t\t\t\t$toggle.hasClass( 'filter-title' )\n\t\t\t) {\n\t\t\t\t// first of all, close other toggles.\n\t\t\t\tthis.maybeCloseAllHorizontalToggles( $target );\n\n\t\t\t\t// now open current one.\n\t\t\t\t$target.toggle( 0, () => {\n\t\t\t\t\t$container.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tthis.toggle( $target, $container );\n\t\t\t}\n\n\t\t\t$target.trigger( 'yith_wcan_after_toggle_element', [ $container ] );\n\t\t} );\n\t}\n\n\t// check if a specific toggle should be shown in Horizontal mode\n\tisHorizontalToggle( $toggle ) {\n\t\tif ( ! this.isHorizontal() ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn $toggle.is( '.collapsable' );\n\t}\n\n\t// close toggle for horizontal layout\n\tmaybeCloseHorizontalToggle( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif (\n\t\t\t! $content.length ||\n\t\t\t! this.isHorizontal() ||\n\t\t\tthis.isMobile ||\n\t\t\t! $toggle.hasClass( 'filter-title' ) ||\n\t\t\t! this.isHorizontalToggle( $toggle )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content.hide();\n\t\t$toggle.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t}\n\n\t// close all Horizontal toggles\n\tmaybeCloseAllHorizontalToggles( $exclude ) {\n\t\t$( '.yith-wcan-filters.horizontal.enhanced' )\n\t\t\t.find( '.filter-title.collapsable' )\n\t\t\t.next( '.filter-content' )\n\t\t\t.not( $exclude )\n\t\t\t.hide()\n\t\t\t.prev( '.filter-title' )\n\t\t\t.removeClass( 'opened' )\n\t\t\t.addClass( 'closed' );\n\t}\n\n\t// add filter content footer for horizontal layout\n\t_addHorizontalToggleFooter( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif (\n\t\t\t! $content.length ||\n\t\t\t! this.isHorizontal() ||\n\t\t\tthis.isMobile ||\n\t\t\t! $toggle.hasClass( 'filter-title' ) ||\n\t\t\t! this.isHorizontalToggle( $toggle ) ||\n\t\t\tyith_wcan_shortcodes.instant_horizontal_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $currentFilter = $toggle.closest( '.yith-wcan-filter' ),\n\t\t\t$footer = $( '<div/>', {\n\t\t\t\tclass: 'filter-content-footer',\n\t\t\t} ),\n\t\t\t$applyFilterButton = $( '<a/>', {\n\t\t\t\tclass: 'apply-filters button alt',\n\t\t\t\ttext: yith_wcan_shortcodes.labels.save,\n\t\t\t} );\n\n\t\t$applyFilterButton.on( 'click', () => {\n\t\t\tthis.maybeFilter( $applyFilterButton );\n\t\t\tthis.maybeCloseAllHorizontalToggles( $toggle );\n\t\t} );\n\n\t\t$footer.append( $applyFilterButton ).appendTo( $content );\n\t}\n\n\t// add filter content footer for all horizontal toggles\n\t_addAllHorizontalTogglesFooter() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t\tif ( ! $toggle.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._addHorizontalToggleFooter( $toggle );\n\t\t} );\n\t}\n\n\t// remove filter content footer for horizontal layout\n\t_removeHorizontalToggleFooter( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif ( ! $content.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content.find( '.filter-content-footer' ).remove();\n\t}\n\n\t// add filter content footer for all horizontal toggles\n\t_removeAllHorizontalTogglesFooter() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t\tif ( ! $toggle.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._removeHorizontalToggleFooter( $toggle );\n\t\t} );\n\t}\n\n\t// show filters count\n\tmaybeUpdateFiltersCount( $filter ) {\n\t\tconst $toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t// remove current count\n\t\t$toggle.find( '.filter-count' ).remove();\n\n\t\tif (\n\t\t\t! $toggle.length ||\n\t\t\t! this.isHorizontalToggle( $toggle ) ||\n\t\t\t! this.isFilterActive( $filter )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst count = this.countActiveItems( $filter );\n\n\t\t// if there is any filter active, show count\n\t\tif ( ! count ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $counter = $( '<span/>', {\n\t\t\tclass: 'filter-count',\n\t\t\ttext: count,\n\t\t} );\n\n\t\t$toggle.append( $counter );\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport YITH_WCAN_Filter from './modules/yith-wcan-filter';\nimport YITH_WCAN_Filter_Labels from './modules/yith-wcan-filter-labels';\nimport YITH_WCAN_Reset_Button from './modules/yith-wcan-reset-button';\nimport YITH_WCAN_Modal_Opener from './modules/yith-wcan-modal-opener';\nimport YITH_WCAN_Preset from './modules/yith-wcan-preset-premium';\n\njQuery( function ( $ ) {\n\t$( document )\n\t\t.on(\n\t\t\t'yith_wcan_init_shortcodes yith_plugin_fw_gutenberg_success_do_shortcode',\n\t\t\tfunction () {\n\t\t\t\t$( '.yith-wcan-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Preset( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-active-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Filter_Labels( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-reset-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Reset_Button( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-filters-opener' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Modal_Opener( $( this ) );\n\t\t\t\t\t} );\n\t\t\t}\n\t\t)\n\t\t.trigger( 'yith_wcan_init_shortcodes' );\n\n\tglobalThis.product_filter = new YITH_WCAN_Filter();\n} );\n"],"names":["$","jQuery","$body","block","$el","fn","background","yith_wcan_shortcodes","loader","message","overlayCSS","opacity","unblock","serialize","formatName","filterItems","result","inputs","find","not","filter","each","t","name","attr","value","replace","is","val","indexOf","components","split","map","c","firstComponent","shift","newItem","reverse","reduce","res","key","extend","removeHierarchyFromString","trim","YITH_WCAN_Filter","location","search","initPopState","initialized","reload_on_back","pushUrlToHistory","window","document","title","on","history","state","_yithWcan","reload","filters","target","preset","targetUrl","$target","customFilters","triggerHandler","buildUrl","ajax_filters","doingAjax","_doAjax","done","response","searchAlternativeUrl","_beforeFilter","refreshFragments","pageTitle","originalSearch","_afterFilter","trigger","query_vars","closest","submit","filtered","Object","keys","length","addClass","removeClass","queryParam","query_param","params","url","base_url","origin","pathname","self","haveFilters","session_param","RegExp","searchParams","a","v","items","isFilterParam","i","_cleanParam","defaultUrl","matches","match","current","change_browser_url","navigator","userAgent","method","responseDom","createElement","$response","innerHTML","$preset","$destination","replaceWith","first","content","param","process_sanitize","skip_sanitize","encodeURIComponent","xhr","abort","headers","ajax","supportedParams","customParams","concat","supported_taxonomies","YITH_WCAN_Filter_Labels","el","$label_set","_initLabels","data","getLabels","$label","_initLabel","ev","disableLabel","preventDefault","$labels","properties","deactivateFilterByProperties","YITH_WCAN_Reset_Button","$reset","deactivateAllFilters","closeModal","YITH_WCAN_Modal_Opener","$button","_initPreset","_initResponsive","_initActions","modal_on_mobile","hide","media","matchMedia","mobile_media_query","isMobile","_afterLayoutChange","resize","openModal","show","YITH_WCAN_Dropdown","opts","$originalSelect","defaultPerPage","defaultOrder","defaultAll","defaults","showSearch","paginate","perPage","hasMore","order","getElements","labels","emptyLabel","empty_option","searchPlaceholder","search_placeholder","noItemsFound","no_items","showMore","show_more","multiple","prop","options","_hideSelect","_initTemplate","$mainSpan","$labelSpan","html","getLabel","$dropdownSpan","$matchingItemsList","append","_initSearchTemplate","_initShowMoreTemplate","after","$_main","$_label","$_dropdown","$_items","$dropdwonSpan","$container","$search","type","placeholder","prependTo","$_search","$showMore","text","loadNextPage","bind","$_showMore","stopPropagation","toggleDropdown","_populateItems","then","needsRefresh","$li","isActive","hasClass","isValueSelected","toggleClass","_changeItemStatus","siblings","input","parent","change","selfOriginated","updateLabel","globalThis","yith_wcan_dropdown_init","_closeAllDropdowns","_afterDropdownOpen","dropdowns","select","closeDropdown","_closeOtherDropdowns","_maybePopulateItems","_items","$options","getOptions","label","push","getMatchingElements","slice","matchingElements","promise","Promise","resolve","regex","test","call","retrievedElements","_formatItems","indexes","getOptionByValue","active","option","$item","$anchor","template","count","href","rel","$checkbox","prepend","getItems","_emptyItems","_hideLoadMore","_generateItem","_showLoadMore","status","$option","instant_filters","hasSelectedValues","getSelectedLabels","join","getSelectedOptions","found","getSelectedValues","toString","values","YITH_WCAN_Preset","_regiterStatus","_initFilterButton","_initFilters","getFilters","get","_initFilter","loaded","all","maybeShowClearAllFilters","$filterButtons","$filter","handleChange","$currentFilter","$items","children","activeFilters","maybeFilter","maybeToggleClearAllFilters","maybeToggleClearFilter","_maybeLoadFilter","$input","_initFilterChildren","maybeShowClearFilter","_initTooltip","_initPriceSlider","_initDropdown","_initCollapsable","_initShowMore","_initCustomInput","$dropdown","$current","_preset_id","getId","_filter_id","security","nonces","render_filter","originalFilters","_loadFilter","success","filterHTML","remove","$newFilter","$filters","position","th","tooltip","wrapperWidth","outerWidth","left","width","container","css","toFixed","fadeIn","fadeOut","selectWoo","_initDropdownObject","parseInt","terms_per_page","_getTerms","$minInput","$maxInput","min","parseFloat","max","currentMin","currentMax","step","handleSliderChange","sliderTimeout","clearTimeout","setTimeout","off","ionRangeSlider","skin","from","to","min_interval","values_separator","prettify","formatPrice","onChange","onFinish","add","_initTitleCollapsable","_initHierarchyCollapsable","_loadItems","beforeSend","complete","get_filter_terms","render_remaining_terms","$title","_initToggle","parents","show_current_children","$t","$toggle","appendTo","toggle","containerClass","wrap","mergeProperties","getFiltersProperties","_addCloseModalButton","_addApplyFiltersModalButton","_switchToCollapsables","removeAttr","_removeCloseModalButton","_removeApplyFiltersModalButton","_switchBackCollapsables","$closeButton","close","modalElements","closeButton","$filterButton","show_results","applyFiltersButton","removeData","isFilterActive","end","currentFilters","currentStr","JSON","stringify","originalStr","dirty","$initiator","maybeRegisterStatusChange","inhibitFilters","product_filter","doFilter","newPreset","scroll_top","targetOffset","offset","top","scroll_target","$scrollTarget","animate","scrollTop","getActiveFilters","filterType","filteredActive","Math","abs","filteredProperties","$active","activeTerms","taxonomy","isAttr","relation","pop","glue","rating_filter","price_ranges","min_price","max_price","onsale_filter","instock_filter","featured_filter","orderby","filterProperties","getFilterProperties","hasProp","includes","maybeHideClearFilter","isAnyFilterActive","maybeHideClearAllFilters","show_clear_filter","clear_selection","role","deactivateFilter","clear_all_selections","$activeItems","click","formattedRange","$priceSlider","getFiltersByProperties","classToAdd","classToRemove","openFilter","closeFilter","toggles_open_on_modal","_openAllCollapsables","_closeAllCollapsables","price","accounting","formatMoney","symbol","currency_format","decimal","thousand","precision","format","set1","set2","hasOwnProperty","newValue","index","arr","queryTypeParam","YITH_WCAN_Dropdown_Premium","getPreset","YITH_WCAN_Preset_Premium","isHorizontal","yith_wcan_backdrop_init","_initBackdropClick","maybeCloseAllHorizontalToggles","isHorizontalToggle","maybeUpdateFiltersCount","instant_horizontal_filter","$clearButton","maybeCloseHorizontalToggle","_removeAllHorizontalTogglesFooter","_addAllHorizontalTogglesFooter","_addHorizontalToggleFooter","$content","next","$exclude","prev","$footer","$applyFilterButton","save","_removeHorizontalToggleFooter","countActiveItems","$counter"],"sourceRoot":""}